try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="33269d70-ce85-4163-9bc9-65900d384912",e._sentryDebugIdIdentifier="sentry-dbid-33269d70-ce85-4163-9bc9-65900d384912")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9061],{58741:function(e,t,r){var i;"undefined"!=typeof self&&self,i=e=>(()=>{"use strict";var t,r,i,n,a,o,s=[,t=>{t.exports=e}],l={};function d(e){var t=l[e];if(void 0!==t)return t.exports;var r=l[e]={exports:{}};return s[e](r,r.exports,d),r.exports}d.d=(e,t)=>{for(var r in t)d.o(t,r)&&!d.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var h={};d.r(h),d.d(h,{HTML5Player:()=>Q,HTML5PlayerBase:()=>z,WebAudioContext:()=>R,buildNumber:()=>$,errors:()=>a,helpers:()=>o,version:()=>K});var u=d(1);function _(e){let t=[],r=e.length;for(let i=0;i<r;i++)t.push({end:1e3*e.end(i),start:1e3*e.start(i)});return u.TimeRange.normalizeRawTimeRanges(t).map(e=>new u.TimeRange(e.start,e.end-e.start))}(t=n||(n={}))[t.UP=0]="UP",t[t.DOWN=1]="DOWN";class c{constructor(e,t){this._context=e,this._gain=t,this._currentFade={startTime:0,startValue:1,rate:0},this._fadeEndTimer=null}isFading(){return!!this._fadeEndTimer}getDirection(){let{rate:e,startValue:t}=this._currentFade;return 0===e?0===t?n.DOWN:n.UP:e<0?n.DOWN:n.UP}performFade(e,t){if(0===e)throw Error("Rate cannot be 0.");this._fadeEndTimer&&window.clearTimeout(this._fadeEndTimer);let r=this._context.currentTime,i=this._gain;if(e===1/0||e===-1/0){i.gain.cancelScheduledValues(r);let n=e===1/0?1:0;i.gain.setValueAtTime(n,r),this._currentFade={startTime:r,startValue:n,rate:0},this._fadeEndTimer=null,t&&t()}else{let n=this._currentFade,a=Math.min(1,Math.max(0,n.startValue+1e3*n.rate*(r-n.startTime))),o=e>0?1-a:a,s=1/Math.abs(1e3*e)*o,l=r+s;this._currentFade={startTime:r,rate:e,startValue:a},i.gain.cancelScheduledValues(r),i.gain.setValueAtTime(a,r),i.gain.linearRampToValueAtTime(e>0?1:0,l),this._fadeEndTimer=window.setTimeout(()=>{this._fadeEndTimer=null,t&&t()},1e3*s)}}}class p extends u.errors.PlayerFatalError{constructor(){super("An unrecoverable network error occurred.")}getCode(){return"HTML5_PLAYER.NETWORK_ERROR"}}class g extends u.errors.PlayerFatalError{constructor(){super("An unrecoverable error occurred whilst decoding.")}getCode(){return"HTML5_PLAYER.DECODE_ERROR"}}class m extends u.errors.PlayerFatalError{constructor(e){super("Unexpected error from media element.",e),this._error=e}getCode(){return`HTML5_PLAYER.UNEXPECTED_MEDIA_ELEMENT_ERROR_${this._error&&this._error.code||"UNKNWON"}`}}class f extends u.errors.PlayerFatalError{constructor(e){super("An error occurred when initializing the media element.",e)}getCode(){return"HTML5_PLAYER.INITIALIZE_ERROR"}}class y extends u.errors.PlayerFatalError{constructor(e="An error occurred when activating web audio.",t){super(e,t)}getCode(){return"HTML5_PLAYER.WEB_AUDIO_ACTIVATION_ERROR"}}class E extends y{constructor(e){super("We timed out when trying to activate web audio.",e)}getCode(){return"HTML5_PLAYER.WEB_AUDIO_ACTIVATION_TIMEOUT_ERROR"}}class v extends u.errors.PlayerError{constructor(e="An error occurred when initializing web audio.",t){super(e,t)}getCode(){return"HTML5_PLAYER.WEB_AUDIO_INITIALIZE_ERROR"}}class b extends v{constructor(e){super("Web audio found no channels.",e)}getCode(){return"HTML5_PLAYER.WEB_AUDIO_INITIALIZE_NO_CHANNELS_ERROR"}}class P{constructor(e,t=2e4){this._audioContext=e,this._idleTime=t,this._players=[],this._prevPlayingCount=0,this._playingCount=0,this._timerId=null,this._suspendTimerId=null,this._suspendSupported="function"==typeof e.suspend}watchPlayer(e){!(!this._suspendSupported||e.isDead()||this._players.indexOf(e)>=0)&&(e.onChange.subscribe(({dead:t,playing:r})=>{if(void 0!==r&&this._handleCountChange(r),t){let t=this._players.indexOf(e);t>=0&&(this._players.splice(t,1),!this._players.length&&this._suspendTimerId&&(window.clearInterval(this._suspendTimerId),this._suspendTimerId=null))}}),this._players.length||(this._suspendTimerId=window.setInterval(()=>{0===this._playingCount&&null===this._timerId&&"suspended"!==this._audioContext.state&&this._scheduleSuspend(5e3)},5e3)),this._players.push(e),e.isPlaying()&&this._handleCountChange(!0))}_handleCountChange(e){e?this._playingCount++:this._playingCount--,this._playingCount!==this._prevPlayingCount&&(this._prevPlayingCount=this._playingCount,0===this._playingCount?this._scheduleSuspend(this._idleTime):1===this._playingCount&&this._abortSuspend())}_scheduleSuspend(e){this._timerId=window.setTimeout(()=>{this._timerId=null,this._audioContext.suspend()},e)}_abortSuspend(){this._timerId&&(window.clearTimeout(this._timerId),this._timerId=null)}}let w=u.helpers.browser.getFirefoxVersion(),S=Error("Web audio activation timed out."),A=Error("Web audio found no output channels."),x=null;function T(){return"AudioContext"in window&&(u.helpers.browser.isChrome()||w&&w.major>=48||u.helpers.browser.isEdge())}function C(){if(x)return x;if(!T())throw Error("Web audio is not enabled.");let e=new window.AudioContext;if(!e.destination.maxChannelCount)throw A;return x={context:e,suspender:new P(e)}}class R{getAudioContextWithSuspender(){return T()?C():null}activate(){if(!T())return u.helpers.Promise.resolve(void 0);try{let{context:e}=C();return e.state&&e.resume&&"running"!==e.state?u.helpers.promiseWithTimeout(e.resume(),5e3,S):u.helpers.Promise.resolve()}catch(e){return u.helpers.Promise.reject(e)}}}function O(e,t={}){let r=e.mimeType||t.mimeType;if(!r)return null;let i=e.audioCodec||t.audioCodec,n=e.videoCodec||t.videoCodec,a=u.helpers.compact([i,n]);return r+(a.length>0?`; codecs="${a.map(e=>e.id).join(",")}"`:"")}let M=u.helpers.deferred.buildDeferred,k=u.helpers.url.getExtension,L=u.helpers.time.now,{Promise:I,browser:D}=u.helpers,F=u.logger.prefixLogger,{NotSupportedError:U,PlayerFatalError:N}=u.errors,j=Error("Media element was revoked."),B=[],W=new u.helpers.SCWeakMap,H=null,V=u.helpers.retry.buildExponentialDelayCalculator({jitter:0,timeBase:50});function q(e){try{return!!document.createElement("audio").canPlayType(e)}catch(e){return!1}}class z extends u.BasePlayer{constructor(e){super(e),this._duration=null,this._stallDetected=!1,this._fadeManagers=null,this._shouldCoverGlitch=!0,this._initialized=!1,this._muted=!1,this._volume=1,this._deferredProvideMediaElementCallback=null,this._playInProgress={inProgress:!1},this._lastStallCheckPos=null,this._stallCheckTimerId=null,this._timeWhenPositionChanged=0,this._endedOverride=!1,this._pauseEventTimer=null,this._positionWhenMediaElementRevoked=0,this._playingWhenMediaElementRevoked=!1,this._provideMediaElementDeferred=null,this._mediaElementAndState=null,this._listeners=[],this._currentSeek=null,this._playDetectionPosition=0,this._playDetectionTimer=null,this._playDetectionTimerNumAttempts=0,this._fadeRate=null,this._seekFadeRate=null,this._lastSeek=null,this._webAudioOrchestration=null,this._fadeEndedHandle=null,this._onSeekFadeOutCompleted=null,this._fadeRateAfterSeek=1/0,this._mediaElPlayShouldBeAborted=new u.helpers.SCWeakMap,this._mediaElPaused=new u.helpers.SCWeakMap,this._mediaElPlayTracker=null,this._logger=F(this._logger,"HTML5PlayerBase"),this._playerDependencies=e,this._webAudioContext=e.webAudioContext||H||(H=new R),this._addCachedCurrentTimeListeners();let t=this._webAudioOrchestration=e.fadeSupportEnabled?this._initWebAudio():null;t&&(this._logger.debug("Fading supported."),this._fadeManagers={pausePlay:new c(t.context,t.gainNodes.pausePlay),seek:new c(t.context,t.gainNodes.seek)}),this._handleDurationUpdates();let r=void 0!==e.mediaElement?e.mediaElement:this._createDefaultMediaElement();r&&this.provideMediaElement(r).catch(e=>{if(e===j){this._logger.debug("Initial provideMediaElement() call was aborted.");return}this._triggerError(new f(e))});let i=this._fadeManagers;i&&this.onChange.subscribe(({stalled:e,seek:t,ended:r})=>{if(r&&i.seek.getDirection()===n.UP&&i.seek.isFading())this._logger.debug("Completing fade in after seek early because reached end."),i.seek.performFade(1/0),this._notifyFadingForSeek(!1);else{let r=this.getSeekState(),a=r&&"COMPLETED"===r.state,o=t&&"COMPLETED"===t.state;(!1===e&&a||o&&!this.isStalled())&&i.seek.getDirection()===n.DOWN&&(this._logger.debug("Fading in after seek.",this._fadeRateAfterSeek),i.seek.performFade(this._fadeRateAfterSeek,()=>this._notifyFadingForSeek(!1)))}}),this._logger.info("Checking if the player can play the provided descriptor."),this._canPlayTimer=window.setTimeout(()=>{this._canPlay().then(e=>{if(!this.isDead()){if(e instanceof u.errors.NotSupportedError){this._logger.info("Player not supported.",e),this._triggerError(e);return}if(e)this._logger.info("Player supported."),this._initialize();else{this._logger.info("Player not supported."),this._triggerError(new U);return}}}).catch(e=>{this._logger.error("Unexpected error during can play check.",e),this._triggerError(new N("An unexpected error occured during initialization.",e))})},0)}static isFormatSupported(e){let t=O(e);return!!t&&q(t)}getMediaElement(){return this._mediaElementAndState&&this._mediaElementAndState.element}provideMediaElement(e){if(this._ensureNotDead(),this._mediaElementAndState)throw Error("Already have a media element.");if(B.indexOf(e)>=0)throw Error("The same media element is currently being used in another player.");if(!this._webAudioOrchestration&&W.has(e))throw Error("The same media element has been used in another player with fading enabled.");B.push(e);let t=this._provideMediaElementDeferred=M();return this._update(()=>{this._logger.debug("provideMediaElement() called.",e),this._initMediaElementLocal(e,!1);let r=this._mediaElementAndState={element:e,state:"INITIALIZING"},i=()=>{this._logger.debug("Initializing media element."),this._initMediaElement(e,!0),this._addPausedHandlers(e),this._attachListeners();let i=this._listenToOnce("error",()=>{this._provideMediaElementDeferred=null;let r=e.error,i=r?r.code:"unknown";this._logger.error("Error whilst initializing media element.",i),this.revokeMediaElement(),t.reject(Error("Error when initializing media element. Error: "+i))},{earlyAttach:!0}),n=()=>{this._logger.debug("Putting media element in the state that is expected..."),a()},a=()=>{null===this._getQueuedSeekPosition()&&this._positionWhenMediaElementRevoked>0?(this._logger.debug("Seeking to expected position..."),this._performSeek(this._positionWhenMediaElementRevoked,e=>{if(void 0!==e){this._provideMediaElementDeferred=null,this._logger.error("An error occurred when trying to seek to the expected position."),this.revokeMediaElement(),t.reject(Error("An error occurred when trying to restore the position."));return}this._logger.debug("Seeked to expected position."),o()})):o()},o=()=>{this.isPlaying()===this.isActuallyPlaying()&&this._playingWhenMediaElementRevoked?(this._logger.debug("Calling play to match previous state..."),this._mediaElementPlay().catch(e=>{this._provideMediaElementDeferred=null,this._logger.error("An error occurred when trying to play.",e),r===this._mediaElementAndState&&this.revokeMediaElement(),t.reject(Error("Browser refused play() request on media element."))}),this._listenToOnce("play",()=>{this._logger.debug("Play succeeded."),s()},{earlyAttach:!0})):s()},s=()=>{if(this._mediaElementAndState!==r){this._triggerError(new N("Media element switched unexpectedly."));return}this._provideMediaElementDeferred=null,i.remove(),t.resolve(void 0),this._mediaElementAndState.state="STABLE",this._logger.debug("Finished putting element in expected state."),this._shouldCoverGlitch=!0,null!==this._duration&&this._update(()=>{this.isReady()||this._signalReady(),this._handleDeferredPauseAndSeek()})};this._listenToOnce("emptied",()=>{this._logger.debug("Got emptied event from media element."),n()},{earlyAttach:!0})};this._initialized?i():this._deferredProvideMediaElementCallback=i}),t.promise}revokeMediaElement(){if(!this._mediaElementAndState)throw Error("There is no media element to revoke.");this._deferredProvideMediaElementCallback=null,this._provideMediaElementDeferred&&(this._provideMediaElementDeferred.reject(j),this._provideMediaElementDeferred=null),this._logger.debug("revokeMediaElement() called."),this._detachListeners();let e=this._mediaElementAndState.element,t=B.indexOf(e);t>=0&&B.splice(t,1),this._onSeekFadeOutCompleted=null,this.isDead()||(this._positionWhenMediaElementRevoked=this.getPosition(),this._playingWhenMediaElementRevoked=this.isPlaying()),this._mediaElementAndState=null,this._initMediaElement(e,!1),this._removePausedHandlers(e),this._completeCurrentFade(),this._completeSeekFadeOutAndIn(),this._update(()=>{this.isDead()||(!this.isPlaying()&&this.isActuallyPlaying()&&this._notifyPlaying(!1),this._handleStalled())})}getBufferedTimeRanges(){return this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state?_(this._mediaElementAndState.element.buffered):[]}getMaxBufferLength(){return null}_hasInitialized(){return this._initialized}_inferFormat(e){switch(k(e)){case"mp3":return{mimeType:"audio/mpeg"};case"opus":return{mimeType:"audio/ogg",audioCodec:{id:"opus"}};case"mp4":return{mimeType:"video/mp4"};case"m4a":return{mimeType:"audio/mp4"};case"m3u8":return{mimeType:"application/x-mpegURL"};default:return{}}}_canPlayType(e){return q(e)}_initialize(){this._initialized=!0,this._listenTo("error",()=>{if("INITIALIZING"===this._mediaElementAndState.state){this._logger.debug("An error occurred, but the media element is initializing, so ignoring...");return}let e=this._mediaElementAndState.element.error;switch(e&&e.code){case 2:this._triggerError(new p);break;case 3:this._triggerError(new g);break;default:this._logger.error("Unexpected error from media element.",e&&e.code,e&&e.message),this._triggerError(new m(e))}},{earlyAttach:!0}),this._listenTo("play",()=>{this._logger.debug("Media element play event."),this._updateCachedCurrentTime(),this.isPlaying()||this.isActuallyPlaying()||!this._mediaElementAndState||this._isMediaElementPaused(this._mediaElementAndState.element)||(this._logger.debug("Calling play() because something external called play() on media element."),this.play())}),this._listenTo("playing",()=>{this._logger.debug("Media element playing event."),this._updateCachedCurrentTime(),this._mediaElementAndState&&!this._isMediaElementPaused(this._mediaElementAndState.element)?this._handlePlayingEvent():this._logger.debug("Ignoring playing event because media element is reporting it is paused.")}),this._listenTo("timeupdate",()=>{this._updateCachedCurrentTime(),this._determineIfPlaying()}),this._listenTo("pause",()=>{this._logger.debug("Media element pause event."),this._updateCachedCurrentTime(),this._mediaElementAndState&&this._isMediaElementPaused(this._mediaElementAndState.element)?this._handlePauseEvent():this._logger.debug("Ignoring pause event because media element is reporting it is not paused.")}),this._listenTo("seeking",()=>{if(null===this._getQueuedSeekPosition()&&(this._logger.debug("Media element seeking event."),this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state)){let e=1e3*this._mediaElementAndState.element.currentTime,t=this._lastSeek;if(t&&(null===t.unstallTime||t.unstallTime+500>L())&&500>=Math.abs(t.position-e)){this._logger.debug("Ignoring seeking event because we seeked recently to somewhere near.");return}let r=this._mediaElementAndState.cachedMediaElTime.elTime;this._logger.debug(`Reverting seek on media element to ${r}.`),this._mediaElementAndState.element.currentTime=r/1e3,this._updateCachedCurrentTime(),this._lastSeek={unstallTime:L(),position:r},this.seek(e,{fadeOutDuration:0}).catch(t=>{this._logger.warn(`Error when trying to seek to ${e} whilst handling seeking event`,t)})}}),this._listenTo("ended",()=>{this._logger.debug("Media element ended event."),this._mediaElementAndState&&this._mediaElementAndState.element.ended?this._handleEndedEvent():this._logger.debug("Ignoring ended event because media element is reporting it is not ended.")}),this._listenTo("stalled",()=>{this._logger.debug("Media element stalled event."),this._checkIfStalled()}),this._listenTo("volumechange",()=>{this._mediaElementAndState&&this._notifyVolumeChangeFromMediaEl(this._mediaElementAndState.element)}),this._stallCheckTimerId=window.setInterval(()=>this._checkIfStalled(),400),this._deferredProvideMediaElementCallback&&this._deferredProvideMediaElementCallback()}_handleDurationChange(){let e=this._duration;null!==e&&this._update(()=>{this._provideDuration(e),this._mediaElementAndState&&"STABLE"===this._mediaElementAndState.state&&(this.isReady()||this._signalReady(),this._handleDeferredPauseAndSeek())})}_createDefaultMediaElement(){return document.createElement(this._playerDependencies.mediaElementType||"audio")}_handlePauseEvent(){if(!this._mediaElementAndState)throw Error("Media element should exist.");let e=this._mediaElementAndState.element;this.isActuallyPlaying()&&this._update(()=>{e.ended||(this._notifyNotStalled(),this._completeCurrentFade(),this._completeSeekFadeOutAndIn(),this._notifyPlaying(!1))})}_handlePlayingEvent(){let e=this._duration;if(null===e)throw Error("Expecting duration to exist.");let t=this._getTruePosition();if(t>=e){this._logger.warn("Got a media element playing event and the positon was >= the duration.",t,e);return}if(this.isEnded()||this._shouldBeEnded()){this._logger.warn("Got a media element playing event when the player is/should be ended.");return}this._update(()=>{this._notifyNotStalled(),this._determineIfPlaying(),this.isActuallyPlaying()||(this._playDetectionTimerNumAttempts=0,this._playDetectionTimer||(this._playDetectionTimer=window.setInterval(()=>this._determineIfPlaying(),10)))})}_handleEndedEvent(){if(null!==this._getQueuedSeekPosition()){this._logger.warn("Got a media element ended event but ignoring because a seek is in progress.");return}this._update()}_shouldBeEnded(){return this._endedOverride||this._mediaElementReportingEnded()}_mediaElementReportingEnded(){return!!(this._mediaElementAndState&&this._mediaElementAndState.element.ended&&this._mediaElementAndState.element.paused)}_handleDurationUpdates(){this._listenToOnce("loadedmetadata",()=>this._updateDurationFromMediaElement(),{reattach:!0,earlyAttach:!0}),this._listenTo("durationchange",()=>this._updateDurationFromMediaElement())}_updateDurationFromMediaElement(){let e=this._mediaElementAndState;e&&(this._duration=1e3*e.element.duration,this._handleDurationChange())}_handlePlayPauseChange(e,{fadeRate:t}){this._fadeRate=t||null;let r=()=>{this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state&&this._callMediaElementPause(this._mediaElementAndState.element),this._notifyFading(!1),this._completeSeekFadeOutAndIn(),this._notifyPlaying(!1)};if(this.isEnded())e?this._notifyPlaying(!0):r();else if(this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state){let i=this._playInProgress.inProgress||!this._isMediaElementPaused(this._mediaElementAndState.element);e&&!i?(this._fadeManagers&&this._fadeManagers.pausePlay.performFade(-1/0),this._playDetectionPosition=this._getTruePosition(),this._play(e=>this._notifyPlayRejection(e))):!e&&i?this._update(()=>{this._fadeManagers&&this._fadeManagers.pausePlay.getDirection()===n.UP?(this._notifyFading(!0),this._fadeManagers.pausePlay.performFade(t||-1/0,()=>r())):r()}):e&&i?this._update(()=>{this._fadeManagers&&this._fadeManagers.pausePlay.getDirection()===n.DOWN&&this._fadeManagers.pausePlay.performFade(t||1/0,()=>this._notifyFading(!1)),this._notifyPlaying(!0)}):this._notifyPlaying(e)}}_handleVolumeChange(e,t){if(this._mediaElementAndState){let r=this._mediaElementAndState.element;r.muted=t,r.volume=e,this._notifyVolumeChangeFromMediaEl(r)}else this._muted=t,this._volume=e,this._notifyVolumeChange(e,t)}_handleSeekChange(e,{fadeRate:t}){this._seekFadeRate=t,this._fadeRateAfterSeek=t.afterSeek||1/0;let r=this._mediaElementAndState;if(r&&"USABLE"===r.state){this._onSeekFadeOutCompleted=()=>{this._onSeekFadeOutCompleted=null,i&&i.remove(),r&&r.seek.getDirection()===n.DOWN&&(this._logger.debug("Fade out for seek completed.",e,t),r.seek.performFade(-1/0),this._notifyFadingForSeek(!1));let a=this._mediaElementReportingEnded();this._endedOverride=!1;let o=this._lastSeek={position:e,unstallTime:null};this._performSeek(e,t=>{if(void 0!==t){this._triggerError(new u.errors.PlayerFatalError("An error occurred when trying to seek.",t));return}e===this._duration&&(this._endedOverride=!0),this._update(()=>{if(this.isActuallyPlaying()&&this._assumeStalled(),this._updateCachedCurrentTime(!0),this._signalSeekComplete(),this.isStalled()){let e=this.onChange.subscribe(({dead:t,stalled:r})=>{t?e.remove():r||(o.unstallTime=L(),e.remove())})}else o.unstallTime=L();r&&(!this.isActuallyPlaying()||this._fadeRateAfterSeek===1/0||this.isEnded()?r.seek.performFade(1/0):this._notifyFadingForSeek(!0))})}),a&&this.isPlaying()&&this._play(e=>{this._triggerError(new u.errors.PlayerFatalError("Error when trying to play after seek from end.",e))})},this._fadeEndedHandle&&(this._fadeEndedHandle.remove(),this._fadeEndedHandle=null);let r=this._fadeManagers,i=null,a=()=>{this._onSeekFadeOutCompleted&&this._onSeekFadeOutCompleted()};this._update(()=>{r&&(t.beforeSeek||t.afterSeek)?(this._logger.debug("Fading out ready for seek.",e,t),(r.seek.getDirection()===n.UP||r.seek.isFading())&&this.isActuallyPlaying()&&t.beforeSeek&&!this._mediaElementReportingEnded()?(this._notifyFadingForSeek(!0),i=this._fadeEndedHandle=this._listenToOnce("ended",a),r.seek.performFade(t.beforeSeek||-1/0,a)):(r.seek.performFade(-1/0),a())):a()})}}_performSeek(e,t){let r=this._mediaElementAndState;if(!r)throw Error("Media element does not exist.");let i=this._currentSeek;i&&(this._currentSeek=null,i.abort());let n=r.element,a=0,o=e,s=()=>{let r=[],i=()=>{this._currentSeek&&(this._currentSeek.abort(),this._currentSeek=null),t()};try{n.currentTime=o/1e3}catch(t){this._logger.warn("Error when trying to seek.",t,e,o)}this._playDetectionPosition=1e3*n.currentTime;let l=window.setTimeout(()=>{this._logger.warn("Seek attempt failed. Retrying...",e,o,a),d(),o+=.001,s()},V(++a));r.push(this._listenToOnce("seeked",()=>{let t=1e3*n.currentTime;100>=Math.abs(t-o)?i():(this._logger.warn("Seek attempt failed. Incorect position. Retrying...",t,e,o),d(),s())},{earlyAttach:!0}));let d=()=>{r.forEach(e=>e.remove()),window.clearTimeout(l)};this._currentSeek={abort:d}};s()}_getPosition(){let e=null!==this._duration?this._duration:1/0;if(!this._mediaElementAndState||"USABLE"!==this._mediaElementAndState.state)return this._positionWhenMediaElementRevoked;this._determineIfPlaying();let t=Math.min(this._getTruePosition(),e);return this._shouldBeEnded()?e:t}_getTruePosition(){if(!this._mediaElementAndState||"USABLE"!==this._mediaElementAndState.state)throw Error("Media element does not exist or is in invalid state.");let{elTime:e,systemTime:t}=this._mediaElementAndState.cachedMediaElTime;return this.isStalled()||!this.isActuallyPlaying()?e:e+(L()-t)}_kill(){window.clearTimeout(this._canPlayTimer),this._playDetectionTimer&&window.clearInterval(this._playDetectionTimer),this._mediaElementAndState&&this.revokeMediaElement(),this._stallCheckTimerId&&window.clearInterval(this._stallCheckTimerId),this._webAudioOrchestration&&this._webAudioOrchestration.gainNodes.glitchCoverup.disconnect(this._webAudioOrchestration.context.destination),this._listeners=[]}_listenToOnce(e,t,r={}){let{reattach:i,earlyAttach:n}=r;void 0===i&&(i=!1),void 0===n&&(n=!1);let a=this._listenTo(e,e=>{a.remove(),t(e)},{reattach:i,earlyAttach:n});return a}_listenTo(e,t,r={}){let{reattach:i,earlyAttach:n}=r;void 0===i&&(i=!0),void 0===n&&(n=!1);let a=r=>{if(o.attachedToElement)switch(e){case"play":{let e=this._mediaElPlayShouldBeAborted.get(o.attachedToElement);if(this._mediaElPlayShouldBeAborted.delete(o.attachedToElement),e){this._logger.warn("Calling pause() on media element because the play request should have been rejected."),o.attachedToElement.pause();break}}default:t(r)}else this._logger.warn("Got media element event after handler was removed. Ignoring.",r)},o={attachedToElement:null,handler:a,eventType:e,once:!1,reattach:i,earlyAttach:n};if(this._listeners.push(o),!this._mediaElementAndState||"USABLE"!==this._mediaElementAndState.state&&!n)return{remove:()=>{let e=this._listeners.indexOf(o);e>=0&&this._listeners.splice(e,1)}};let{element:s}=this._mediaElementAndState;return s.addEventListener(e,a,!1),o.attachedToElement=s,{remove:()=>{let t=this._listeners.indexOf(o);t>=0&&(this._listeners.splice(t,1),o.attachedToElement=null,s.removeEventListener(e,a,!1))}}}_notifyNotStalled(){this._stallDetected=!1,this._lastStallCheckPos=null,this._handleStalled()}_assumeStalled(){this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state&&(this._lastStallCheckPos=1e3*this._mediaElementAndState.element.currentTime,this._timeWhenPositionChanged=0,this._stallDetected=!0,this._handleStalled())}_initMediaElement(e,t){this._initMediaElementLocal(e,t)}_callMediaElementPlay(e){D.isEdge()&&this._mediaElPlayShouldBeAborted.set(e,!1);let t=this._mediaElPaused.get(e);t&&(t.paused=!1);let r=this._mediaElPlayTracker={},i=e.play();return t&&i&&i.catch&&i.catch(()=>{r===this._mediaElPlayTracker&&(t.paused=!0)}),i}_callMediaElementPause(e){this._playInProgress.inProgress=!1,D.isEdge()&&this._mediaElPlayShouldBeAborted.has(e)&&this._mediaElPlayShouldBeAborted.set(e,!0);let t=this._mediaElPaused.get(e);t&&(t.paused=!0),e.pause()}_isMediaElementPaused(e){let t=this._mediaElPaused.get(e);return!t||t.paused}_createMediaElementSource(e){if(this._webAudioOrchestration&&this._fadeManagers){this._logger.debug("Creating media element source node...");let t=W.get(e);if(t?this._logger.debug("Reusing media element source node."):(t=this._webAudioOrchestration.context.createMediaElementSource(e),W.set(e,t)),this._webAudioOrchestration.mediaElementSource=t,t.connect(this._webAudioOrchestration.gainNodes.pausePlay),this._logger.debug("Created media element source node."),this._shouldCoverGlitch){let e=this._webAudioOrchestration.context.currentTime,t=this._webAudioOrchestration.gainNodes.glitchCoverup;t.gain.setValueAtTime(0,e),t.gain.setValueAtTime(1,e+.1),this._shouldCoverGlitch=!1}}}_completeCurrentFade(){let e=this._fadeManagers;e&&(e.pausePlay.performFade(this.isPlaying()?1/0:-1/0),this.isDead()||this._notifyFading(!1))}_completeSeekFadeOutAndIn(){let e=this._fadeManagers;e&&this._update(()=>{e.seek.performFade(1/0),!this.isDead()&&(this._notifyFadingForSeek(!1),this._onSeekFadeOutCompleted&&this._onSeekFadeOutCompleted())})}_determineIfPlaying(){this._playDetectionTimer&&(!this.isPlaying()||++this._playDetectionTimerNumAttempts>=200)&&(window.clearInterval(this._playDetectionTimer),this._playDetectionTimer=null),this._update(()=>{this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state&&!this.isDead()&&this.isReady()&&this.isPlaying()&&!this.isActuallyPlaying()&&!this._isMediaElementPaused(this._mediaElementAndState.element)&&this._getTruePosition()!==this._playDetectionPosition&&(this._logger.debug("Detected that playback has started."),this._playDetectionTimer&&(window.clearInterval(this._playDetectionTimer),this._playDetectionTimer=null),this._notifyPlaying(!0),this._fadeManagers&&(this._notifyFading(!0),this._fadeManagers.pausePlay.performFade(this._fadeRate||1/0,()=>this._notifyFading(!1))))})}_updateCachedCurrentTime(e=!1){this._mediaElementAndState&&"USABLE"===this._mediaElementAndState.state&&(e||!this._mediaElementAndState.element.seeking)&&(this._mediaElementAndState.cachedMediaElTime={elTime:1e3*this._mediaElementAndState.element.currentTime,systemTime:L()})}_addCachedCurrentTimeListeners(){this.onChange.subscribe(({actuallyPlaying:e,stalled:t})=>{(void 0!==e||void 0!==t)&&this._updateCachedCurrentTime()})}_initMediaElementLocal(e,t){if(e.setAttribute("msAudioCategory","BackgroundCapableMedia"),e.mozAudioChannelType="content",e.removeAttribute("src"),function(e){e.load()}(e),this._activateWebAudio(),this._pauseEventTimer&&(this._logger.debug("Clearing pause event timer."),window.clearTimeout(this._pauseEventTimer),this._pauseEventTimer=null),this._webAudioOrchestration&&this._webAudioOrchestration.mediaElementSource&&(this._logger.debug("Disconnecting media element from gain node."),this._webAudioOrchestration.mediaElementSource.disconnect(this._webAudioOrchestration.gainNodes.pausePlay),this._webAudioOrchestration.mediaElementSource=void 0),this._currentSeek&&(this._logger.debug("Aborting seek attempt."),this._currentSeek.abort(),this._currentSeek=null),t){this._webAudioOrchestration&&(this._logger.debug("Adding crossorigin attribute to media element because fading enabled."),e.setAttribute("crossorigin","anonymous"));let t=this._getUrlForMediaElement();this._logger.debug("Setting media element src.",t),e.src=t,e.volume=this._volume,e.muted=this._muted,this._createMediaElementSource(e)}e.playbackRate=1,e.setAttribute("preload","metadata"),this._callMediaElementPause(e),e.load()}_addPausedHandlers(e){let t={removeListeners:()=>{e.removeEventListener("play",r),e.removeEventListener("playing",r),e.removeEventListener("pause",r),e.removeEventListener("ended",r)},paused:!1},r=()=>{t.paused=e.paused};r(),e.addEventListener("play",r),e.addEventListener("playing",r),e.addEventListener("pause",r),e.addEventListener("ended",r),this._mediaElPaused.set(e,t)}_removePausedHandlers(e){let t=this._mediaElPaused.get(e);t&&t.removeListeners(),this._mediaElPaused.delete(e)}_checkIfStalled(){if(!this._mediaElementAndState||"USABLE"!==this._mediaElementAndState.state||!this.isActuallyPlaying())return;let e=this._mediaElementAndState.element,t=1e3*e.currentTime,r=u.helpers.time.now();t!==this._lastStallCheckPos&&(this._timeWhenPositionChanged=r),this._stallDetected=e.readyState<=2||this._timeWhenPositionChanged<=r-500,this._lastStallCheckPos=t,this._handleStalled()}_handleStalled(){this._shouldBeEnded()&&null===this._getQueuedSeekPosition()?this.isEnded()||(this._logger.debug("Updating because stalled near end."),this._update()):this._notifyStalled(this._stallDetected||!this._mediaElementAndState||"USABLE"!==this._mediaElementAndState.state)}_play(e){let t=this._activateWebAudio(),r={inProgress:!0};this._playInProgress=r,this._mediaElementPlay().then(()=>{r.inProgress=!1,t.catch(e=>{this._logger.error("Error activating web audio.",e),e===S?this._triggerError(new E):this._triggerError(new y)})}).catch(t=>{if(this._playInProgress!==r){this._logger.debug("Ignoring play error because paused since.",t);return}r.inProgress=!1,e&&e(t)})}_mediaElementPlay(){if(this._mediaElementAndState){if(this._mediaElementReportingEnded())return this._logger.debug("Not calling play() because we are at the end. It will be called after a seek."),I.resolve()}else throw Error("Media element doesn't exist.");let e=this._mediaElementAndState.element,t=this._callMediaElementPlay(e);return new I((e,r)=>{t?(t=t.then(()=>e())).catch&&(t=t.catch(t=>{"AbortError"===t.name?(this._logger.debug("Media element play() promise rejected with AbortError."),e()):r(t)})):e()})}_notifyVolumeChangeFromMediaEl(e){this._volume=e.volume,this._muted=e.muted,this._notifyVolumeChange(e.volume,e.muted)}_initWebAudio(){try{let e=this._webAudioContext.getAudioContextWithSuspender();if(!e)return this._logger.debug("WebAudio not supported/enabled."),null;this._logger.debug("WebAudio supported.");let{context:t,suspender:r}=e;r.watchPlayer(this);let i=t.createGain(),n=t.createGain(),a=t.createGain();return i.connect(n),n.connect(a),a.connect(t.destination),{context:t,suspender:r,gainNodes:{glitchCoverup:a,pausePlay:i,seek:n}}}catch(e){return e===A?this._triggerError(new b(e)):this._triggerError(new v(e)),this._logger.error("Failed initializing web audio.",e),null}}_activateWebAudio(){return this._webAudioOrchestration?this._webAudioContext.activate():I.resolve(void 0)}_handleDeferredPauseAndSeek(){if(!this._mediaElementAndState||"STABLE"!==this._mediaElementAndState.state)throw Error("Media element must be in the STABLE state.");this._logger.debug("Handling deferred pause and seek...");let e=this._mediaElementAndState.element;this._mediaElementAndState={state:"USABLE",element:e,cachedMediaElTime:{systemTime:L(),elTime:1e3*e.currentTime}},this._attachListeners(),this._update(()=>{this._handleStalled();let e=this._getQueuedSeekPosition();if(null!==e){let t=this._seekFadeRate?this._seekFadeRate.afterSeek:void 0;this._handleSeekChange(e,{fadeRate:{afterSeek:t}})}this.isPlaying()!==this.isActuallyPlaying()&&this._handlePlayPauseChange(this.isPlaying(),{fadeRate:this._fadeRate||void 0})})}_detachListeners(){if(!this._mediaElementAndState)throw Error("Media element doesn't exist.");let e=this._mediaElementAndState.element;this._listeners.forEach(t=>{t.attachedToElement&&(t.attachedToElement=null,e.removeEventListener(t.eventType,t.handler,!1))}),this._listeners=this._listeners.filter(e=>e.reattach)}_attachListeners(){if(!this._mediaElementAndState)throw Error("Media element doesn't exist.");this._logger.debug("Attaching listeners...");let{element:e,state:t}=this._mediaElementAndState;this._listeners.forEach(r=>{!r.attachedToElement&&r.reattach&&("USABLE"===t||r.earlyAttach)&&(e.addEventListener(r.eventType,r.handler,!1),r.attachedToElement=e)}),this._logger.debug("Attached listeners.")}}let G=u.helpers.Promise;class Q extends z{constructor(e,t){super(t),this._descriptor=e,this._mimeType=e.format.mimeType||O(e.format,this._inferFormat(e.url))}_getUrlForMediaElement(){return this._descriptor.url}_canPlay(){return this._mimeType&&this._canPlayType(this._mimeType)?G.resolve(!0):G.resolve(!1)}}(r=a||(a={})).DecodeError=g,r.NetworkError=p,r.MediaElementError=m,r.WebAudioInitializeError=v,r.WebAudioInitializeNoChannelsError=b,r.WebAudioActivationError=y,r.WebAudioActivationTimeoutError=E,((i=o||(o={})).timeRanges||(i.timeRanges={})).buildTimeRanges=_,(i.mimeType||(i.mimeType={})).buildMimeTypeFromFormat=O;let K="31.1.0",$=2227;return h})(),e.exports=i(r(48567))},8636:function(e,t,r){var i;"undefined"!=typeof self&&self,i=e=>(()=>{"use strict";var t=[,t=>{t.exports=e}],r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};i.r(n),i.d(n,{ArrayBufferLoader:()=>g,arrayBufferLoader:()=>m,buildNumber:()=>y,stringLoader:()=>d,version:()=>f});var a=i(1);class o extends a.loader.LoaderRequest{constructor(e,t={},r=2e4){if(super(),this._responseStarted=!1,r<0)throw Error("Invaid timeout.");if(this._timeoutTimer=window.setTimeout(()=>this._onManualTimeout(),r),this._xhr=new XMLHttpRequest,this._xhr.addEventListener("load",()=>this._onLoad()),this._xhr.addEventListener("abort",()=>this._onAbort()),this._xhr.addEventListener("error",e=>this._onError(e)),this._xhr.addEventListener("timeout",()=>this._onTimeout()),this._xhr.addEventListener("loadend",()=>this._onLoadEnd()),this._xhr.addEventListener("progress",()=>this._onProgress()),this._xhr.open("GET",e,!0),this._xhr.timeout=r,!this._getResponseType().some(e=>(this._xhr.responseType=e,this._xhr.responseType===e)))throw Error("Failed setting response type.");Object.keys(t).forEach(e=>this._xhr.setRequestHeader(e,t[e])),this._signalRequestStart(),this._xhr.send()}_abort(){this._xhr.abort()}_onAbort(){this.hasCompleted()||this._onTimeout()}_onManualTimeout(){this.hasCompleted()||(this._signalTimeout(),this._xhr.abort())}_onTimeout(){this.hasCompleted()||this._signalTimeout()}_onLoad(){if(!this.hasCompleted()){if(!this._isChunkedResponse()){let e=this._xhr;this._provideStatusAndHeaders({statusCode:e.status,headers:this._parseHeaders(e.getAllResponseHeaders()||"")},e.response)}this.hasCompleted()||this._finalize()}}_onError(e){switch(this.getState()){case a.loader.ResponseState.COMPLETED:case a.loader.ResponseState.ERRORED:break;case a.loader.ResponseState.PENDING:if(0===this._xhr.status){this._provideStatusAndHeaders({statusCode:0,headers:{}},this._getEmptyData()),this._finalize();break}default:this._finalize(new a.loaderErrors.LoaderError("An error occurred.",e))}}_onLoadEnd(){window.clearTimeout(this._timeoutTimer),this.hasCompleted()||this._finalize(new a.loaderErrors.LoaderError("Unexpected error occurred."))}_onProgress(){if(this.hasCompleted())return;let e=this._xhr;this._isChunkedResponse()&&(this._responseStarted?this._providePart(e.response):(this._responseStarted=!0,this._provideStatusAndHeaders({statusCode:e.status,headers:this._parseHeaders(e.getAllResponseHeaders()||"")},e.response)))}_isChunkedResponse(){return"moz-chunked-arraybuffer"===this._xhr.responseType}_parseHeaders(e){let t={};if(!e)return t;let r=e.split("\r\n");for(let e=0,i=r.length;e<i;e++){let i=r[e],n=i.indexOf(": ");if(n>0){let e=i.substring(0,n).trim(),r=i.substring(n+2);t[e]=r}}return t}}let s=["text"];class l extends o{_getResponseType(){return s}_getEmptyData(){return""}_reduceParts(e){return e.join("")}}let d={request:({url:e,headers:t,timeout:r})=>new l(e,t,r)},h=a.helpers.browser.getFirefoxVersion(),u=h&&h.major>=60?["moz-chunked-arraybuffer","arraybuffer"]:["arraybuffer"];class _ extends o{_getResponseType(){return u}_getEmptyData(){return new ArrayBuffer(0)}_reduceParts(e){return a.helpers.arrayBuffer.combine(e.map(e=>new Uint8Array(e))).buffer}}let c=a.helpers.browser.isFirefox();class p extends a.loader.LoaderRequest{constructor(e,t={},r=2e4){if(super(),!p.isSupported())throw Error("Not supported.");let i=new Request(e,{headers:t,redirect:"follow",signal:(this._abortController=new AbortController).signal});this._signalRequestStart();let n=this._abortTimer=window.setTimeout(()=>{this._signalTimeout(),this._abort()},r),o=fetch(i).then(e=>{let t={};if(e.headers.forEach((e,r)=>t[e]=r),this._provideStatusAndHeaders({statusCode:e.status,headers:t},new ArrayBuffer(0)),!e.body)return e.arrayBuffer().then(e=>{e&&this._providePart(e)});{let t=e.body.getReader(),r=()=>t.read().then(({done:e,value:t})=>{if(!(e||this.hasCompleted()))return this._providePart(t.buffer),r()});return r()}}).then(()=>{this.hasCompleted()||this._finalize()}).catch(e=>{if(this.hasCompleted())return;let t=e instanceof a.loaderErrors.LoaderError?e:new a.loaderErrors.LoaderError(e);this._finalize(t)});a.helpers.always(o,()=>window.clearTimeout(n))}static isSupported(){return"fetch"in window&&"Request"in window&&"AbortController"in window&&!c}_abort(){window.clearTimeout(this._abortTimer),this._abortController.abort()}_reduceParts(e){return a.helpers.arrayBuffer.combine(e.map(e=>new Uint8Array(e))).buffer}}class g{constructor({fetchEnabled:e=!0}={}){this._fetchEnabled=e}request({url:e,headers:t,timeout:r}){return this._fetchEnabled&&p.isSupported()?new p(e,t,r):new _(e,t,r)}}let m=new g,f="31.1.0",y=2227;return n})(),e.exports=i(r(48567))},19061:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t,r)=>(()=>{"use strict";var i=[,t=>{t.exports=e},e=>{e.exports=t},e=>{e.exports=r}],n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return i[e](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};a.r(o),a.d(o,{HTML5Player:()=>d.HTML5Player,HTML5PlayerController:()=>h,MediaElementManager:()=>c,buildNumber:()=>g,version:()=>p});var s=a(1),l=a(2),d=a(3);class h extends s.BaseController{constructor(e){super(),this._mediaElementManager=e,this.name="MaestroHTML5"}static errorQualifiesAbort(e){return!(e instanceof d.errors.WebAudioInitializeError)}isRenditionSupported(e,t,r){let i="mp3"===e.scFormat||"aac"===e.scFormat,n="hls"===e.scProtocol,a=r&&r.useIphoneHlsHack&&i&&function(e){try{return!!document.createElement("audio").canPlayType(e)}catch(e){return!1}}("application/vnd.apple.mpegurl");if(a&&n)return!0;let o="cbc-encrypted-hls"===e.scProtocol;return!!(a&&o&&r.fairPlayManager&&s.FairPlayManager.isSupported())||("http"===e.scProtocol||-1!==["hls","encrypted-hls"].indexOf(e.scProtocol)&&!t.streamUrlExpires)&&d.HTML5Player.isFormatSupported(e.maestroFormat)}buildPlayer(e){let{rendition:t,timeRetrieved:r}=e.urlAndRendition,i="hls"===t.scProtocol||"encrypted-hls"===t.scProtocol,n=-1!==navigator.userAgent.indexOf("iPhone"),a=e.useIphoneHlsHack&&n,o=e.fairPlayManager;if(a&&i);else if(a&&o&&"cbc-encrypted-hls"===t.scProtocol){let t=new u(e,this._mediaElementManager);return o.registerPlayer(t.getPlayer()),t}else if(e.streamUrlExpires&&(i||!(void 0!==r)))throw s.notSupportedError;return new u(e,this._mediaElementManager)}}class u{constructor(e,t){this._config=e,this._mediaElementManager=t;let{logger:r,playerId:i,urlAndRendition:n,streamUrlExpires:a,reportError:o,fadeOnPauseAndPlay:s,fadeOnSeek:l,releaseControl:u,seekStrategy:_}=e;this._logger=r;let{rendition:c,timeRetrieved:p}=n;if(a){if(void 0===p)throw Error("Expecting timeUrlRetrieved to be set.");this._expirationConfig={urlExpires:!0,timeUrlRetrieved:p}}else this._expirationConfig={urlExpires:!1};let g=this._player=new d.HTML5Player({url:n.url,format:c.maestroFormat},{name:i,mediaElement:null,fadeSupportEnabled:s||l,defaultFadeDuration:s?void 0:0,defaultSeekFadeInDuration:l?void 0:0,defaultSeekFadeOutDuration:l?void 0:0,webAudioContext:this._mediaElementManager.getWebAudioContext(),logger:this._logger,seekStrategy:_,registerListeners:({onError:e,onChange:t})=>{e.subscribe(e=>{e instanceof d.errors.NetworkError&&this._hasExpired()?(this._logger.info("Releasing control as a network error occurred, and the URL has expired."),u({retry:!0})):(o(e.getCode()),h.errorQualifiesAbort(e)&&u({retry:!1}))}),t.subscribe(({dead:e,playing:t,actuallyPlaying:r,seeking:i,duration:n})=>{if(e){u({retry:!1});return}if(n===1/0){this._logger.info("Releasing control because the duration was Infinity."),u({retry:!1});return}this._expirationConfig.urlExpires&&(t||r||i)&&this._checkIfUrlWillExpireBeforeEnd()})}});this._mediaElementManager.registerPlayer(g,()=>u({retry:!1}))}getPlayer(){return this._player}getUrl(){return this._config.urlAndRendition.url}_checkIfUrlWillExpireBeforeEnd(){let e=this._player.getDuration(),t=this._getExpireTime();if(null!==e&&null!==t){let r=e-this._player.getPosition();l.helpers.time.now()+r>t&&(this._logger.info("Releasing control because stream URL would expire before reaching end."),this._config.releaseControl({retry:!0}))}}_getExpireTime(){if(!this._expirationConfig.urlExpires)return null;let e=this._player.getDuration();return null===e?null:this._expirationConfig.timeUrlRetrieved+e+105e3}_hasExpired(){let e=this._getExpireTime();return null!==e&&e<=l.helpers.time.now()}}let _=new d.WebAudioContext;class c{constructor(e,t){this._type=e,this._playerListeners=new l.helpers.SCWeakMap,this._playerWithElement=null,this._canActivate=!0,this._provideMediaElementErrorRunCheck={},this._element=document.createElement(e),this._logger=l.logger.prefixLogger(t,"MediaElementManager")}activate(){this._canActivate&&(this._logger.debug("Activating media element."),this._element.load()),this._logger.debug("Activating web audio context."),_.activate()}registerPlayer(e,t,r=!1){if(this._playerListeners.has(e))throw Error("Player already registered.");let i=()=>{if(e.getMediaElement()!==this._element){this._playerWithElement&&(this._playerWithElement.getMediaElement()===this._element&&(this._logger.debug("Revoking media element from previous player."),this._playerWithElement.isPlaying()&&this._logger.warn("Revoking media element from a playing player."),this._playerWithElement.revokeMediaElement()),this._playerWithElement=null),this._canActivate=!1,r&&(this._logger.debug("Creating new media element."),this._element=document.createElement(this._type));let i=this._provideMediaElementErrorRunCheck={};this._logger.debug("Providing media element to new player."),e.provideMediaElement(this._element).catch(r=>{e.isDead()||this._provideMediaElementErrorRunCheck!==i||(this._logger.error("Error occurred providing media element to new player.",r),t(r))}),this._playerWithElement=e}},n=e.onChange.subscribe(({playing:e})=>{e&&i()});this._playerListeners.set(e,n),e.getMediaElement()&&e.revokeMediaElement(),e.isPlaying()&&i()}unregisterPlayer(e){let t=this._playerListeners.get(e);t&&(t.remove(),this._playerWithElement===e&&(this._playerWithElement=null,e.getMediaElement()===this._element&&e.revokeMediaElement()),this._playerListeners.delete(e))}getWebAudioContext(){return _}}let p="24.1.3",g=1201;return o})(),e.exports=i(r(27229),r(48567),r(58741))},27229:function(e,t,r){var i;"undefined"!=typeof self&&self,i=(e,t)=>(()=>{"use strict";var r,i,n,a,o,s,l=[,t=>{t.exports=e},(e,t,r)=>{e.exports=r(3)()?Map:r(4)},e=>{e.exports=function(){var e,t;if("function"!=typeof Map)return!1;try{e=new Map([["raz","one"],["dwa","two"],["trzy","three"]])}catch(e){return!1}return"[object Map]"===String(e)&&3===e.size&&"function"==typeof e.clear&&"function"==typeof e.delete&&"function"==typeof e.entries&&"function"==typeof e.forEach&&"function"==typeof e.get&&"function"==typeof e.has&&"function"==typeof e.keys&&"function"==typeof e.set&&"function"==typeof e.values&&!1===(t=e.entries().next()).done&&!!t.value&&"raz"===t.value[0]&&"one"===t.value[1]}},(e,t,r)=>{var i,n=r(5),a=r(9),o=r(18),s=r(23),l=r(6),d=r(24),h=r(36),u=r(37),_=r(42),c=r(46),p=r(60),g=r(63),m=Function.prototype.call,f=Object.defineProperties,y=Object.getPrototypeOf;e.exports=i=function(){var e,t,r,n=arguments[0];if(!(this instanceof i))throw TypeError("Constructor requires 'new'");return r=g&&o&&Map!==i?o(new Map,y(this)):this,null!=n&&_(n),f(r,{__mapKeysData__:d("c",e=[]),__mapValuesData__:d("c",t=[])}),n&&c(n,function(r){var i=l(r)[0];r=r[1],-1===a.call(e,i)&&(e.push(i),t.push(r))},r),r},g&&(o&&o(i,Map),i.prototype=Object.create(Map.prototype,{constructor:d(i)})),h(f(i.prototype,{clear:d(function(){this.__mapKeysData__.length&&(n.call(this.__mapKeysData__),n.call(this.__mapValuesData__),this.emit("_clear"))}),delete:d(function(e){var t=a.call(this.__mapKeysData__,e);return -1!==t&&(this.__mapKeysData__.splice(t,1),this.__mapValuesData__.splice(t,1),this.emit("_delete",t,e),!0)}),entries:d(function(){return new p(this,"key+value")}),forEach:d(function(e){var t,r,i=arguments[1];for(s(e),r=(t=this.entries())._next();void 0!==r;)m.call(e,i,this.__mapValuesData__[r],this.__mapKeysData__[r],this),r=t._next()}),get:d(function(e){var t=a.call(this.__mapKeysData__,e);if(-1!==t)return this.__mapValuesData__[t]}),has:d(function(e){return -1!==a.call(this.__mapKeysData__,e)}),keys:d(function(){return new p(this,"key")}),set:d(function(e,t){var r,i=a.call(this.__mapKeysData__,e);return -1===i&&(i=this.__mapKeysData__.push(e)-1,r=!0),this.__mapValuesData__[i]=t,r&&this.emit("_add",i,e),this}),size:d.gs(function(){return this.__mapKeysData__.length}),values:d(function(){return new p(this,"value")}),toString:d(function(){return"[object Map]"})})),Object.defineProperty(i.prototype,u.iterator,d(function(){return this.entries()})),Object.defineProperty(i.prototype,u.toStringTag,d("c","Map"))},(e,t,r)=>{var i=r(6);e.exports=function(){return i(this).length=0,this}},(e,t,r)=>{var i=r(7);e.exports=function(e){if(!i(e))throw TypeError("Cannot use null or undefined");return e}},(e,t,r)=>{var i=r(8)();e.exports=function(e){return e!==i&&null!==e}},e=>{e.exports=function(){}},(e,t,r)=>{var i=r(10),n=r(13),a=r(6),o=Array.prototype.indexOf,s=Object.prototype.hasOwnProperty,l=Math.abs,d=Math.floor;e.exports=function(e){var t,r,h;if(!i(e))return o.apply(this,arguments);for(r=n(a(this).length),h=arguments[1],t=h=isNaN(h)?0:h>=0?d(h):n(this.length)-d(l(h));t<r;++t)if(s.call(this,t)&&i(this[t]))return t;return -1}},(e,t,r)=>{e.exports=r(11)()?Number.isNaN:r(12)},e=>{e.exports=function(){var e=Number.isNaN;return"function"==typeof e&&!e({})&&e(NaN)&&!e(34)}},e=>{e.exports=function(e){return e!=e}},(e,t,r)=>{var i=r(14),n=Math.max;e.exports=function(e){return n(0,i(e))}},(e,t,r)=>{var i=r(15),n=Math.abs,a=Math.floor;e.exports=function(e){return isNaN(e)?0:0!==(e=Number(e))&&isFinite(e)?i(e)*a(n(e)):e}},(e,t,r)=>{e.exports=r(16)()?Math.sign:r(17)},e=>{e.exports=function(){var e=Math.sign;return"function"==typeof e&&1===e(10)&&-1===e(-20)}},e=>{e.exports=function(e){return isNaN(e=Number(e))||0===e?e:e>0?1:-1}},(e,t,r)=>{e.exports=r(19)()?Object.setPrototypeOf:r(20)},e=>{var t=Object.create,r=Object.getPrototypeOf,i={};e.exports=function(){var e=Object.setPrototypeOf,n=arguments[0]||t;return"function"==typeof e&&r(e(n(null),i))===i}},(e,t,r)=>{var i,n,a,o,s=r(21),l=r(6),d=Object.prototype.isPrototypeOf,h=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};o=function(e,t){if(l(e),null===t||s(t))return e;throw TypeError("Prototype must be null or an object")},e.exports=(i=function(){var e,t=Object.create(null),r={},i=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(i){try{(e=i.set).call(t,r)}catch(e){}if(Object.getPrototypeOf(t)===r)return{set:e,level:2}}return(t.__proto__=r,Object.getPrototypeOf(t)===r)?{level:2}:((t={}).__proto__=r,Object.getPrototypeOf(t)===r&&{level:1})}())?(2===i.level?i.set?(a=i.set,n=function(e,t){return a.call(o(e,t),t),e}):n=function(e,t){return o(e,t).__proto__=t,e}:n=function e(t,r){var i;return o(t,r),(i=d.call(e.nullPolyfill,t))&&delete e.nullPolyfill.__proto__,null===r&&(r=e.nullPolyfill),t.__proto__=r,i&&h(e.nullPolyfill,"__proto__",u),t},Object.defineProperty(n,"level",{configurable:!1,enumerable:!1,writable:!1,value:i.level})):null,r(22)},(e,t,r)=>{var i=r(7),n={function:!0,object:!0};e.exports=function(e){return i(e)&&n[typeof e]||!1}},(e,t,r)=>{var i,n,a,o,s=Object.create;r(19)()||(o=r(20)),e.exports=o&&1===o.level?(i={},n={},a={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){if("__proto__"===e){n[e]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}n[e]=a}),Object.defineProperties(i,n),Object.defineProperty(o,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:i}),function(e,t){return s(null===e?i:e,t)}):s},e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function");return e}},(e,t,r)=>{var i=r(25),n=r(31),a=r(32),o=r(33);(e.exports=function(e,t){var r,a,s,l,d;return arguments.length<2||"string"!=typeof e?(l=t,t=e,e=null):l=arguments[2],null==e?(r=s=!0,a=!1):(r=o.call(e,"c"),a=o.call(e,"e"),s=o.call(e,"w")),d={value:t,configurable:r,enumerable:a,writable:s},l?i(n(l),d):d}).gs=function(e,t,r){var s,l,d,h;return"string"!=typeof e?(d=r,r=t,t=e,e=null):d=arguments[3],null==t?t=void 0:a(t)?null==r?r=void 0:a(r)||(d=r,r=void 0):(d=t,t=r=void 0),null==e?(s=!0,l=!1):(s=o.call(e,"c"),l=o.call(e,"e")),h={get:t,set:r,configurable:s,enumerable:l},d?i(n(d),h):h}},(e,t,r)=>{e.exports=r(26)()?Object.assign:r(27)},e=>{e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},(e,t,r)=>{var i=r(28),n=r(6),a=Math.max;e.exports=function(e,t){var r,o,s,l=a(arguments.length,2);for(o=1,e=Object(n(e)),s=function(i){try{e[i]=t[i]}catch(e){r||(r=e)}};o<l;++o)t=arguments[o],i(t).forEach(s);if(void 0!==r)throw r;return e}},(e,t,r)=>{e.exports=r(29)()?Object.keys:r(30)},e=>{e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},(e,t,r)=>{var i=r(7),n=Object.keys;e.exports=function(e){return n(i(e)?Object(e):e)}},(e,t,r)=>{var i=r(7),n=Array.prototype.forEach,a=Object.create,o=function(e,t){var r;for(r in e)t[r]=e[r]};e.exports=function(e){var t=a(null);return n.call(arguments,function(e){i(e)&&o(Object(e),t)}),t}},e=>{e.exports=function(e){return"function"==typeof e}},(e,t,r)=>{e.exports=r(34)()?String.prototype.contains:r(35)},e=>{var t="razdwatrzy";e.exports=function(){return"function"==typeof t.contains&&!0===t.contains("dwa")&&!1===t.contains("foo")}},e=>{var t=String.prototype.indexOf;e.exports=function(e){return t.call(this,e,arguments[1])>-1}},(e,t,r)=>{var i,n,a,o,s,l,d,h=r(24),u=r(23),_=Function.prototype.apply,c=Function.prototype.call,p=Object.create,g=Object.defineProperty,m=Object.defineProperties,f=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};i=function(e,t){var r;return u(t),f.call(this,"__ee__")?r=this.__ee__:(r=y.value=p(null),g(this,"__ee__",y),y.value=null),r[e]?"object"==typeof r[e]?r[e].push(t):r[e]=[r[e],t]:r[e]=t,this},n=function(e,t){var r,n;return u(t),n=this,i.call(this,e,r=function(){a.call(n,e,r),_.call(t,this,arguments)}),r.__eeOnceListener__=t,this},s={on:i,once:n,off:a=function(e,t){var r,i,n,a;if(u(t),!f.call(this,"__ee__")||!(r=this.__ee__)[e])return this;if("object"==typeof(i=r[e]))for(a=0;n=i[a];++a)(n===t||n.__eeOnceListener__===t)&&(2===i.length?r[e]=i[a?0:1]:i.splice(a,1));else(i===t||i.__eeOnceListener__===t)&&delete r[e];return this},emit:o=function(e){var t,r,i,n,a;if(f.call(this,"__ee__")&&(n=this.__ee__[e])){if("object"==typeof n){for(t=1,r=arguments.length,a=Array(r-1);t<r;++t)a[t-1]=arguments[t];for(t=0,n=n.slice();i=n[t];++t)_.call(i,this,a)}else switch(arguments.length){case 1:c.call(n,this);break;case 2:c.call(n,this,arguments[1]);break;case 3:c.call(n,this,arguments[1],arguments[2]);break;default:for(t=1,r=arguments.length,a=Array(r-1);t<r;++t)a[t-1]=arguments[t];_.call(n,this,a)}}}},d=m({},l={on:h(i),once:h(n),off:h(a),emit:h(o)}),e.exports=t=function(e){return null==e?p(d):m(Object(e),l)},t.methods=s},(e,t,r)=>{e.exports=r(38)()?Symbol:r(39)},e=>{var t={object:!0,symbol:!0};e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!t[typeof Symbol.iterator]&&!!t[typeof Symbol.toPrimitive]&&!!t[typeof Symbol.toStringTag]}},(e,t,r)=>{var i,n,a,o,s,l=r(24),d=r(40),h=Object.create,u=Object.defineProperties,_=Object.defineProperty,c=Object.prototype,p=h(null);if("function"==typeof Symbol){n=Symbol;try{String(n()),s=!0}catch(e){}}var g=(i=h(null),function(e){for(var t,r,n=0;i[e+(n||"")];)++n;return i[e+=n||""]=!0,_(c,t="@@"+e,l.gs(null,function(e){r||(r=!0,_(this,t,l(e)),r=!1)})),t});o=function(e){if(this instanceof o)throw TypeError("Symbol is not a constructor");return a(e)},e.exports=a=function e(t){if(this instanceof e)throw TypeError("Symbol is not a constructor");return s?n(t):u(h(o.prototype),{__description__:l("",t=void 0===t?"":String(t)),__name__:l("",g(t))})},u(a,{for:l(function(e){return p[e]?p[e]:p[e]=a(String(e))}),keyFor:l(function(e){var t;for(t in d(e),p)if(p[t]===e)return t}),hasInstance:l("",n&&n.hasInstance||a("hasInstance")),isConcatSpreadable:l("",n&&n.isConcatSpreadable||a("isConcatSpreadable")),iterator:l("",n&&n.iterator||a("iterator")),match:l("",n&&n.match||a("match")),replace:l("",n&&n.replace||a("replace")),search:l("",n&&n.search||a("search")),species:l("",n&&n.species||a("species")),split:l("",n&&n.split||a("split")),toPrimitive:l("",n&&n.toPrimitive||a("toPrimitive")),toStringTag:l("",n&&n.toStringTag||a("toStringTag")),unscopables:l("",n&&n.unscopables||a("unscopables"))}),u(o.prototype,{constructor:l(a),toString:l("",function(){return this.__name__})}),u(a.prototype,{toString:l(function(){return"Symbol ("+d(this).__description__+")"}),valueOf:l(function(){return d(this)})}),_(a.prototype,a.toPrimitive,l("",function(){var e=d(this);return"symbol"==typeof e?e:e.toString()})),_(a.prototype,a.toStringTag,l("c","Symbol")),_(o.prototype,a.toStringTag,l("c",a.prototype[a.toStringTag])),_(o.prototype,a.toPrimitive,l("c",a.prototype[a.toPrimitive]))},(e,t,r)=>{var i=r(41);e.exports=function(e){if(!i(e))throw TypeError(e+" is not a symbol");return e}},e=>{e.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}},(e,t,r)=>{var i=r(43);e.exports=function(e){if(!i(e))throw TypeError(e+" is not iterable");return e}},(e,t,r)=>{var i=r(44),n=r(7),a=r(45),o=r(37).iterator,s=Array.isArray;e.exports=function(e){return!!n(e)&&(!!(s(e)||a(e)||i(e))||"function"==typeof e[o])}},e=>{var t=Object.prototype.toString,r=t.call(function(){return arguments}());e.exports=function(e){return t.call(e)===r}},e=>{var t=Object.prototype.toString,r=t.call("");e.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||t.call(e)===r)||!1}},(e,t,r)=>{var i=r(44),n=r(23),a=r(45),o=r(47),s=Array.isArray,l=Function.prototype.call,d=Array.prototype.some;e.exports=function(e,t){var r,h,u,_,c,p,g,m,f=arguments[2];if(s(e)||i(e)?r="array":a(e)?r="string":e=o(e),n(t),u=function(){_=!0},"array"===r){d.call(e,function(e){return l.call(t,f,e,u),_});return}if("string"===r){for(c=0,p=e.length;c<p&&(g=e[c],c+1<p&&(m=g.charCodeAt(0))>=55296&&m<=56319&&(g+=e[++c]),l.call(t,f,g,u),!_);++c);return}for(h=e.next();!h.done;){if(l.call(t,f,h.value,u),_)return;h=e.next()}}},(e,t,r)=>{var i=r(44),n=r(45),a=r(48),o=r(59),s=r(42),l=r(37).iterator;e.exports=function(e){return"function"==typeof s(e)[l]?e[l]():i(e)?new a(e):n(e)?new o(e):new a(e)}},(e,t,r)=>{var i,n=r(18),a=r(33),o=r(24),s=r(37),l=r(49),d=Object.defineProperty;i=e.exports=function(e,t){if(!(this instanceof i))throw TypeError("Constructor requires 'new'");l.call(this,e),d(this,"__kind__",o("",t=t?a.call(t,"key+value")?"key+value":a.call(t,"key")?"key":"value":"value"))},n&&n(i,l),delete i.prototype.constructor,i.prototype=Object.create(l.prototype,{_resolve:o(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),d(i.prototype,s.toStringTag,o("c","Array Iterator"))},(e,t,r)=>{var i,n=r(5),a=r(25),o=r(23),s=r(6),l=r(24),d=r(50),h=r(37),u=Object.defineProperty,_=Object.defineProperties;e.exports=i=function(e,t){if(!(this instanceof i))throw TypeError("Constructor requires 'new'");_(this,{__list__:l("w",s(e)),__context__:l("w",t),__nextIndex__:l("w",0)}),t&&(o(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete i.prototype.constructor,_(i.prototype,a({_next:l(function(){var e;if(this.__list__){if(this.__redo__&&void 0!==(e=this.__redo__.shift()))return e;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:l(function(){return this._createResult(this._next())}),_createResult:l(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:l(function(e){return this.__list__[e]}),_unBind:l(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:l(function(){return"[object "+(this[h.toStringTag]||"Object")+"]"})},d({_onAdd:l(function(e){if(!(e>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){u(this,"__redo__",l("c",[e]));return}this.__redo__.forEach(function(t,r){t>=e&&(this.__redo__[r]=++t)},this),this.__redo__.push(e)}}),_onDelete:l(function(e){var t;!(e>=this.__nextIndex__)&&(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(e))&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,r){t>e&&(this.__redo__[r]=--t)},this)))}),_onClear:l(function(){this.__redo__&&n.call(this.__redo__),this.__nextIndex__=0})}))),u(i.prototype,h.iterator,l(function(){return this}))},(e,t,r)=>{var i,n=r(51),a=r(31),o=r(23),s=r(56),l=r(23),d=r(6),h=Function.prototype.bind,u=Object.defineProperty,_=Object.prototype.hasOwnProperty;i=function(e,t,r){var i,a=d(t)&&l(t.value);return i=n(t),delete i.writable,delete i.value,i.get=function(){return!r.overwriteDefinition&&_.call(this,e)?a:(t.value=h.call(a,r.resolveContext?r.resolveContext(this):this),u(this,e,t),this[e])},i},e.exports=function(e){var t=a(arguments[1]);return null!=t.resolveContext&&o(t.resolveContext),s(e,function(e,r){return i(r,e,t)})}},(e,t,r)=>{var i=r(52),n=r(25),a=r(6);e.exports=function(e){var t=Object(a(e)),r=arguments[1],o=Object(arguments[2]);if(t!==e&&!r)return t;var s={};return r?i(r,function(t){(o.ensure||t in e)&&(s[t]=e[t])}):n(s,e),s}},(e,t,r)=>{e.exports=r(53)()?Array.from:r(54)},e=>{e.exports=function(){var e,t,r=Array.from;return"function"==typeof r&&!!((t=r(e=["raz","dwa"]))&&t!==e&&"dwa"===t[1])}},(e,t,r)=>{var i=r(37).iterator,n=r(44),a=r(55),o=r(13),s=r(23),l=r(6),d=r(7),h=r(45),u=Array.isArray,_=Function.prototype.call,c={configurable:!0,enumerable:!0,writable:!0,value:null},p=Object.defineProperty;e.exports=function(e){var t,r,g,m,f,y,E,v,b,P,w=arguments[1],S=arguments[2];if(e=Object(l(e)),d(w)&&s(w),this&&this!==Array&&a(this))t=this;else{if(!w){if(n(e))return 1!==(f=e.length)?Array.apply(null,e):((m=[,])[0]=e[0],m);if(u(e)){for(r=0,m=Array(f=e.length);r<f;++r)m[r]=e[r];return m}}m=[]}if(!u(e)){if(void 0!==(b=e[i])){for(E=s(b).call(e),t&&(m=new t),v=E.next(),r=0;!v.done;)P=w?_.call(w,S,v.value,r):v.value,t?(c.value=P,p(m,r,c)):m[r]=P,v=E.next(),++r;f=r}else if(h(e)){for(f=e.length,t&&(m=new t),r=0,g=0;r<f;++r)P=e[r],r+1<f&&(y=P.charCodeAt(0))>=55296&&y<=56319&&(P+=e[++r]),P=w?_.call(w,S,P,g):P,t?(c.value=P,p(m,g,c)):m[g]=P,++g;f=g}}if(void 0===f)for(f=o(e.length),t&&(m=new t(f)),r=0;r<f;++r)P=w?_.call(w,S,e[r],r):e[r],t?(c.value=P,p(m,r,c)):m[r]=P;return t&&(c.value=null,m.length=f),m}},(e,t,r)=>{var i=Object.prototype.toString,n=i.call(r(8));e.exports=function(e){return"function"==typeof e&&i.call(e)===n}},(e,t,r)=>{var i=r(23),n=r(57),a=Function.prototype.call;e.exports=function(e,t){var r={},o=arguments[2];return i(t),n(e,function(e,i,n,s){r[i]=a.call(t,o,e,i,n,s)}),r}},(e,t,r)=>{e.exports=r(58)("forEach")},(e,t,r)=>{var i=r(23),n=r(6),a=Function.prototype.bind,o=Function.prototype.call,s=Object.keys,l=Object.prototype.propertyIsEnumerable;e.exports=function(e,t){return function(r,d){var h,u=arguments[2],_=arguments[3];return r=Object(n(r)),i(d),h=s(r),_&&h.sort("function"==typeof _?a.call(_,r):void 0),"function"!=typeof e&&(e=h[e]),o.call(e,h,function(e,i){return l.call(r,e)?o.call(d,u,r[e],e,r,i):t})}}},(e,t,r)=>{var i,n=r(18),a=r(24),o=r(37),s=r(49),l=Object.defineProperty;i=e.exports=function(e){if(!(this instanceof i))throw TypeError("Constructor requires 'new'");e=String(e),s.call(this,e),l(this,"__length__",a("",e.length))},n&&n(i,s),delete i.prototype.constructor,i.prototype=Object.create(s.prototype,{_next:a(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:a(function(e){var t,r=this.__list__[e];return this.__nextIndex__===this.__length__?r:(t=r.charCodeAt(0))>=55296&&t<=56319?r+this.__list__[this.__nextIndex__++]:r})}),l(i.prototype,o.toStringTag,a("c","String Iterator"))},(e,t,r)=>{var i,n=r(18),a=r(24),o=r(49),s=r(37).toStringTag,l=r(61),d=Object.defineProperties,h=o.prototype._unBind;i=e.exports=function(e,t){if(!(this instanceof i))return new i(e,t);o.call(this,e.__mapKeysData__,e),t&&l[t]||(t="key+value"),d(this,{__kind__:a("",t),__values__:a("w",e.__mapValuesData__)})},n&&n(i,o),i.prototype=Object.create(o.prototype,{constructor:a(i),_resolve:a(function(e){return"value"===this.__kind__?this.__values__[e]:"key"===this.__kind__?this.__list__[e]:[this.__list__[e],this.__values__[e]]}),_unBind:a(function(){this.__values__=null,h.call(this)}),toString:a(function(){return"[object Map Iterator]"})}),Object.defineProperty(i.prototype,s,a("c","Map Iterator"))},(e,t,r)=>{e.exports=r(62)("key","value","key+value")},e=>{var t=Array.prototype.forEach,r=Object.create;e.exports=function(e){var i=r(null);return t.call(arguments,function(e){i[e]=!0}),i}},e=>{e.exports="undefined"!=typeof Map&&"[object Map]"===Object.prototype.toString.call(new Map)},e=>{e.exports=t}],d={};function h(e){var t=d[e];if(void 0!==t)return t.exports;var r=d[e]={exports:{}};return l[e](r,r.exports,h),r.exports}h.d=(e,t)=>{for(var r in t)h.o(t,r)&&!h.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var u={};function _(e){return new c({startPos:e,endPos:0,startLevel:1,endLevel:0,fromEnd:!0})}h.r(u),h.d(u,{BaseController:()=>m,BaseStreamUrlRetriever:()=>p,DecayingExponentialDelayCalculator:()=>v,FairPlayManager:()=>es,Limiter:()=>P,Player:()=>en,Quality:()=>o,UrlRetrieverError:()=>E,allRenditions:()=>y,buildNumber:()=>eh,errors:()=>s,getGlobalMuted:()=>er,getGlobalVolume:()=>ee,notSupportedError:()=>g,renditions:()=>f,resolveQuality:()=>el,setCacheSize:()=>ei,setGlobalMuted:()=>et,setGlobalVolume:()=>X,version:()=>ed,volumeAutomation:()=>a});class c{constructor({startPos:e,endPos:t,startLevel:r,endLevel:i,fromEnd:n=!1}){if(e<0)throw Error("startPos invalid.");if(t<0||!n&&t<e||n&&e<t)throw Error("endPos invalid.");if(r<0||r>1)throw Error("startLevel invalid.");if(i<0||i>1)throw Error("endLevel invalid.");this._startPos=e,this._endPos=t,this._startLevel=r,this._endLevel=i,this._fromEnd=n}calculate(e,t){let r=this._fromEnd?t-500-this._startPos:this._startPos,i=this._fromEnd?t-500-this._endPos:this._endPos;return e<r?{level:this._startLevel,nextCalculatePosition:r-e}:e<=i?{level:this._startLevel+(this._endLevel-this._startLevel)*(-(Math.cos((e-r)/(i-r)*Math.PI)/2)+.5),nextCalculatePosition:e}:{level:this._endLevel,nextCalculatePosition:1/0}}}(r=a||(a={})).Fade=c,r.buildFadeIn=function(e){return new c({startPos:0,endPos:e,startLevel:0,endLevel:1,fromEnd:!1})},r.buildFadeOut=_;class p{}let g=Error("Not supported.");class m{constructor(){this.supportsVolumeAutomation=!0,this.syncConfig={}}}let f={httpMp3:{scProtocol:"http",scFormat:"mp3",maestroFormat:{mimeType:"audio/mpeg"}},httpAACHQ:{scProtocol:"http",scFormat:"aac",maestroFormat:{mimeType:"audio/mp4",audioCodec:{id:"mp4a.40.2"}}},hlsMp3:{scProtocol:"hls",scFormat:"mp3",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/mpeg"}},encryptedHlsMp3:{scProtocol:"encrypted-hls",scFormat:"mp3",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/mpeg"}},hlsOpus:{scProtocol:"hls",scFormat:"opus",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/ogg",audioCodec:{id:"opus"}}},encryptedHlsOpus:{scProtocol:"encrypted-hls",scFormat:"opus",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/ogg",audioCodec:{id:"opus"}}},hlsAACHQ:{scProtocol:"hls",scFormat:"aac",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/mp4",audioCodec:{id:"mp4a.40.2"}}},encryptedHlsAACHQ:{scProtocol:"encrypted-hls",scFormat:"aac",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/mp4",audioCodec:{id:"mp4a.40.2"}}},ctrEncryptedHlsAAC:{scProtocol:"ctr-encrypted-hls",scFormat:"aac",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/mp4",audioCodec:{id:"mp4a.40.2"}}},cbcEncryptedHlsAAC:{scProtocol:"cbc-encrypted-hls",scFormat:"aac",maestroFormat:{mimeType:"application/x-mpegURL"},maestroSegmentFormat:{mimeType:"audio/mp4",audioCodec:{id:"mp4a.40.2"}}},apiMobile:{scProtocol:"sc.api-mobile",maestroFormat:{}},maestroChromecast:{scProtocol:"maestro.chromecast",maestroFormat:{}}},y=Object.keys(f).map(e=>f[e]);class E extends Error{constructor(e="UNKNOWN",t=!1,r=null){super(`UrlRetrieverError: ${e}`),this._code=e,this._transient=t,this._cause=r}isTransient(){return this._transient}getCode(){return this._code}getCause(){return this._cause}}class v{constructor(){this._delayFactor=0,this._lastRequestTime=0}getDelay({maxDelay:e=3e4,numInstantRuns:t=5}={}){let r=Date.now()-this._lastRequestTime;this._lastRequestTime=Date.now(),this._delayFactor=Math.max(0,this._delayFactor-r/e),this._delayFactor++;let i=this._delayFactor-t;return i>0?Math.pow(2,i):0}registerSuccess(){this._delayFactor=Math.max(0,this._delayFactor-2)}}var b=h(1);class P{constructor(){this._jobs=[],this._calculator=new v,this._jobWaiting=!1}execute(e){let t={job:e};return this._jobs.push(t),this._executeNextJob(),{abort:()=>{let e=this._jobs.indexOf(t);e>=0&&this._jobs.splice(e,1)}}}_executeNextJob(){if(!this._jobWaiting){let e=this._jobs.shift();if(e){let t=()=>{this._jobWaiting=!1,this._executeNextJob()},r=this._calculator.getDelay();this._jobWaiting=!0,b.helpers.deferException(()=>{e.job().then(()=>{this._calculator.registerSuccess()})}),0===r?t():window.setTimeout(t,r)}}}}class w{constructor(e=200){this._bufferSize=e,this._log=[]}getLog(){return this._log.map(e=>Object.assign(Object.assign({},e),{data:e.data.map(e=>{try{return JSON.stringify(e)}catch(e){return"<unavailable>"}})}))}debug(e,...t){this._push({level:"debug",msg:e,data:t,time:Date.now()})}info(e,...t){this._push({level:"info",msg:e,data:t,time:Date.now()})}warn(e,...t){this._push({level:"warn",msg:e,data:t,time:Date.now()})}error(e,...t){this._push({level:"error",msg:e,data:t,time:Date.now()})}_push(e){this._log.push(e)>this._bufferSize&&this._log.shift()}}let S=b.helpers.time.now;class A{constructor(){this._start=null,this._end=null}start(){if(this.isComplete())throw Error("Timer completed.");this._start=S()}isComplete(){return null!==this._end}stop(){if(null===this._start)throw Error("Not started.");this._end=S()}getTime(){if(null===this._end)throw Error("Not completed.");return this._end-this._start}}let x=b.helpers.find;class T{constructor({proxy:e,getPlayer:t}){this._getPlayer=t;let r=e.getPosition(),i=this._initialActualPlayer=t();if(i){let e=function(e,t){let r=e.getBufferedTimeRanges();return r?x(r,e=>e.containsTime(t))||new b.TimeRange(t,0):null}(i,r);e?this._initialBuffered=e.end-r:this._initialBuffered=null}else this._initialBuffered=null}getPreloaded(){let e=this._initialBuffered;return null!==e&&this._initialActualPlayer&&this._getPlayer()===this._initialActualPlayer?0===e?"no":e>=2e3?"yes":"partial":null}}function C(){switch(window.document.hidden){case!0:return"background";case!1:return"foreground";default:return}}class R{constructor(e,t,r,i,n){this._logger=b.logger.prefixLogger(i,"AudioPerformanceEventGenerator"),this._proxy=e,this._getPlayer=t,this._eventReporter=r,this._getPlayerDetails=n,this._measureGeneralEvents()}reportManualEvent(e){this._logger.debug("Reporting manual audio performance event.",e),this._eventReporter(e)}_measureGeneralEvents(){let e=this._proxy,t=null,r=null,i=null,n=null,a=null,o=null,s=null,l=!0;e.onChange.subscribe(({playing:d,actuallyPlaying:h,seek:u,seeking:_,stalled:c,ended:p,dead:g})=>{if((!0===g||!1===d)&&n&&(n.stop(),n.getTime()>=1e3&&this._reportEvent("rageSkip",n.getTime(),null),n=null),e.isDead()){s&&window.clearTimeout(s);return}let m=e.getSeekState();!e.isActuallyPlaying()&&!n&&(!0===d||e.isPlaying()&&!0===c)&&(n=new A).start(),!0!==d||t||((t=new A).start(),r=new T({proxy:e,getPlayer:this._getPlayer}),s=window.setTimeout(()=>{this._reportEvent("longInitialBuffering",0,null)},3e4),0!==e.getPosition()||(l=!1)),!1===d&&(s&&window.clearTimeout(s),t&&!t.isComplete()&&(t=null)),!0===h&&(n=null,t&&!t.isComplete()&&(t.stop(),s&&window.clearTimeout(s),this._reportEvent("play",t.getTime(),r.getPreloaded()))),u&&"IN_PROGRESS"===u.state&&e.isReady()&&((i=new A).start(),a=new T({proxy:e,getPlayer:this._getPlayer}),!0===_&&this._reportEvent("seekStart",0,null)),(u&&"COMPLETED"===u.state&&!e.isStalled()||!1===c&&m&&"COMPLETED"===m.state)&&i&&(i.stop(),this._reportEvent("seek",i.getTime(),a.getPreloaded()),i=null),!0===c&&e.isPlaying()&&(!m||"IN_PROGRESS"!==m.state)&&t&&t.isComplete()&&((o=new A).start(),this._reportEvent("rebufferingStart",e.getPosition(),null)),!1===c&&(t&&t.isComplete()&&(n=null),o&&(o.stop(),this._reportEvent("rebufferingEnd",o.getTime(),null),o=null)),!0!==p||l||(this._reportEvent("uninterruptedPlay",0,null),l=!0),!(m&&"IN_PROGRESS"===m.state)&&!0===c&&e.isActuallyPlaying()&&(l=!0)})}_reportEvent(e,t,r){let i=this._getPlayerDetails();if(!i){this._logger.warn("Cannot report event because there is no player.",e,t);return}let n={type:e,latency:t,protocol:i.protocol,playerType:i.name,host:i.host,bitrate:i.bitrate,format:i.format,preset:i.preset,quality:i.quality,preloaded:r||void 0,appState:C()};this._logger.debug("Generated audio performance event.",n),this._eventReporter(n)}}class O{constructor(e,t,r,i,n,a){this._logger=b.logger.prefixLogger(a,"ErrorGenerator"),this._player=e,this._logCollector=t,this._logId=r,this._trackId=i,this._eventReporter=n,this._listenForProxyFatalError()}reportManualEvent(e,t){"NOT_SUPPORTED_ERROR"!==e&&"HLS_MSE_PLAYER.NO_TRANSMUXER_ERROR"!==e&&(this._logger.debug("Reporting manual error event.",e),this._reportEvent(e,t))}_listenForProxyFatalError(){this._player.onError.subscribe(e=>{e instanceof b.errors.PlayerFatalError&&this._reportEvent(e.getCode())})}_reportEvent(e,t){let r={errorCode:e,log:this._logCollector.getLog(),logId:this._logId,trackId:this._trackId,protocol:t&&t.protocol?t.protocol:void 0,playerType:t&&t.name?t.name:"MaestroUnknown",host:t&&t.host,bitrate:t&&t.bitrate,format:t&&t.format?t.format:void 0,preset:t&&t.preset,quality:t&&t.quality,url:t&&t.url,appState:C()};this._logger.debug("Generated audio error event.",r),this._eventReporter(r)}}class M{constructor(e,t,r,i,n){this._checkpointTimer=null,this._logger=b.logger.prefixLogger(i,"AudioEventGenerator"),this._player=e,this._eventReporter=t,this._checkpointInterval=Math.max(1e3,r),this._getPlayerDetails=n,this._startReporting()}_startReporting(){let e=this._player;e.onChange.subscribe(({actuallyPlaying:t,ended:r})=>{!0===t&&!e.isEnded()||!1===r&&e.isActuallyPlaying()?(this._checkpointTimer||(this._checkpointTimer=window.setInterval(()=>{this._reportEvent("checkpoint")},this._checkpointInterval)),this._reportEvent("play")):(!1===t&&!e.isEnded()||!0===r&&e.isActuallyPlaying())&&(this._checkpointTimer&&(window.clearInterval(this._checkpointTimer),this._checkpointTimer=null),this._reportEvent("pause"))})}_reportEvent(e){let t=this._getPlayerDetails();if(!t){this._logger.warn("Cannot report event because there is no player.",e);return}let r=this._player.getDuration();if(null===r)throw Error("Duration should exist now.");let i={type:e,position:this._player.getPosition(),duration:r,preset:t.preset,quality:t.quality,playerType:t.name,appState:C()};this._logger.debug("Generated audio event.",i),this._eventReporter(i)}}var k=h(2);let L=/^[^?#]*/;function I(e,t,r){return{name:t.name,preset:e.preset,bitrate:e.bitrate,protocol:e.rendition.scProtocol,host:function(e){let t=e.split("//",2);return 1===t.length?t[0].split("/",1)[0]:t[1]?t[1].split("/",1)[0]:""}(r),url:function(e){let t=L.exec(e);return t&&t[0]||""}(r),format:e.rendition.scFormat,quality:e.quality}}class D{constructor({logger:e,seekStrategy:t,controllers:r,playerId:i,streamUrlsExpire:n,fetchEnabled:a,fadeOnPauseAndPlay:o,fadeOnSeek:s,cacheManager:l,providePlayer:d,removePlayer:h,streamUrlRetriever:u,getURLOpts:_,errorEventGenerator:c,audioPerformanceEventGenerator:p,useIphoneHlsHack:g,fairPlayManager:m,applicationId:f}){this._quality=null,this._onQualityChanged=new b.eventDispatcher.EventDispatcher,this._controllerIndexByRendition=new k,this._controlledPlayerWithRendition=null,this.onQualityChanged=this._onQualityChanged.getHandle(),this._logger=b.logger.prefixLogger(e,"ControllerManager"),this._seekStrategy=t,this._controllers=r,this._playerId=i,this._streamUrlsExpire=n,this._fetchEnabled=a,this._fadeOnPauseAndPlay=o,this._fadeOnSeek=s,this._useIphoneHlsHack=g,this._fairPlayManager=m,this._applicationId=f,this._cacheManager=l,this._providePlayer=d,this._removePlayer=h,this._streamUrlRetriever=u,this._getURLOpts=_,this._errorEventGenerator=c||null,this._audioPerformanceEventGenerator=p||null}buildNextController(e,t){if(this._controlledPlayerWithRendition)throw Error("A player is already being controlled.");this._logger.debug("Building next controller.");let r=this._controllerIndexByRendition.get(e.rendition)||0;if(r>=this._controllers.length)this._logger.debug("No more controllers for this rendition."),t({excludeRendition:!0,immediateRetry:!0});else{let i=!1;this._manageController(e,this._controllers[r],n=>{if(i)throw Error("performNextAction() already called");i=!0,("MOVE_ON"===n||"MOVE_ON_SAME_RENDITION"===n)&&(this._logger.debug("Controller will not be used again."),this._controllerIndexByRendition.set(e.rendition,r+1)),"MOVE_ON_SAME_RENDITION"===n?this.buildNextController(e,t):t({excludeRendition:!1,immediateRetry:"MOVE_ON"===n})})}}releaseCurrentController({retry:e}){if(!this._controlledPlayerWithRendition)throw Error("There is no player being controlled.");this._controlledPlayerWithRendition.releaseControl({retry:e})}getQuality(){return this._quality}getPlayerDetails(){if(!this._controlledPlayerWithRendition)throw Error("There is no player being controlled.");let{initialUrlAndRendition:e,controller:t,controlledPlayer:r}=this._controlledPlayerWithRendition;return I(e,t,r.getUrl())}_manageController(e,t,r){let i;let n=()=>{this._removePlayer(),this._controlledPlayerWithRendition=null,i&&i.kill()};if(this._logger.debug("Preparing controller.",t.name),!t.isRenditionSupported(e.rendition,{streamUrlExpires:this._streamUrlsExpire},{useIphoneHlsHack:this._useIphoneHlsHack,fairPlayManager:this._fairPlayManager})){this._logger.debug("Skipping controller because rendition not supported."),r("MOVE_ON_SAME_RENDITION");return}let a=!1,o=({retry:e})=>{a||(a=!0,this._logger.debug("Releasing control."),n(),r(e?"RETRY":"MOVE_ON"))};try{this._logger.debug("Building player.");let n=t.buildPlayer({logger:b.logger.prefixLogger(this._logger,`${t.name}-Controller`),seekStrategy:this._seekStrategy,playerId:this._playerId,urlAndRendition:e,streamUrlExpires:this._streamUrlsExpire,fetchEnabled:this._fetchEnabled,releaseControl:o,fadeOnPauseAndPlay:this._fadeOnPauseAndPlay,fadeOnSeek:this._fadeOnSeek,useIphoneHlsHack:this._useIphoneHlsHack,fairPlayManager:this._fairPlayManager,applicationId:this._applicationId,getNewUrl:()=>this._getNewUrlWithSameRendition(e.rendition),reportError:r=>{this._errorEventGenerator&&this._errorEventGenerator.reportManualEvent(r,I(e,t,n?n.getUrl():e.url))},reportPerformance:e=>{!a&&this._audioPerformanceEventGenerator&&this._audioPerformanceEventGenerator.reportManualEvent(e)}});if(i=n.getPlayer(),a)this._logger.warn("Player released during constrution."),i.kill();else if(i.isDead()){let e=i.getFatalError();e instanceof b.errors.NotSupportedError?this._logger.debug("Player not supported (during construction)."):this._logger.error("Error during construction.",e),r("MOVE_ON_SAME_RENDITION")}else{this._logger.debug("Player built."),i.onChange.subscribe(({dead:e,fatalError:t})=>{e&&(t&&this._logger.error("Fatal player error occurred.",t),o({retry:!1}))}),this._cacheManager.addPlayer(i),this._controlledPlayerWithRendition={controller:t,controlledPlayer:n,initialUrlAndRendition:e,releaseControl:o},this._providePlayer(n.getPlayer(),t.syncConfig,t.supportsVolumeAutomation),this._logger.debug("Player provided to proxy.");let r=e.quality||null;this._quality!==r&&(this._logger.debug("Quality changed.",r),this._quality=r,this._onQualityChanged.dispatch(r))}}catch(e){e===g?this._logger.debug("Player not supported. Not constructed."):this._logger.error("Error during construction.",e),n(),r("MOVE_ON_SAME_RENDITION")}}_getNewUrlWithSameRendition(e){return new b.helpers.abortableJob.AbortableJob(()=>{let t=this._streamUrlRetriever.getUrl(this._getURLOpts);return{result:t.whenComplete().then(t=>{let r=null;return t&&t.success&&t.rendition===e&&(r=t.url),r}),abort:()=>t.abort()}}).run()}}function F(e,t){let r=e.getMemoryCacheController();r&&r.setMaxCacheSize(t)}class U{constructor(e,t){this._maxCacheSize=e,this._players=[],this._updateTimer=null,this._logger=b.logger.prefixLogger(t,"CacheManager"),this._logger.debug(`Initialized with cache size ${e} bytes.`)}setCacheSize(e){this._maxCacheSize!==e&&(this._logger.debug(`Updating cache size to ${e} bytes.`),this._maxCacheSize=e,this._update())}addPlayer(e){if(this._logger.debug("Adding player to cache manager."),e.isDead()){this._logger.debug("Player was dead.");return}let t=this._players;e.onChange.subscribe(({playing:r,dead:i})=>{!0===i?(this._logger.debug("Removing player that became dead."),t.splice(t.indexOf(e),1),this._update()):!0===r?(this._logger.debug("Updating because player started playing."),t.splice(t.indexOf(e),1),t.unshift(e),this._update()):!1===r&&(this._logger.debug("Updating because player became paused."),this._update())}),e.isPlaying()?t.unshift(e):t.push(e),this._update()}_update(){if(this._updateTimer&&(window.clearTimeout(this._updateTimer),this._updateTimer=null),0===this._players.length){this._logger.debug("There are no longer any players to manage.");return}let{playingPlayers:e,pausedPlayers:t}=this._players.reduce((e,t)=>(t.isPlaying()?e.playingPlayers.push(t):e.pausedPlayers.push(t),e),{playingPlayers:[],pausedPlayers:[]}),r=e.reduce((e,t)=>e+(t.getMemoryCacheUsage()||0),0),i=t.reduce((e,t)=>e+(t.getMemoryCacheUsage()||0),0);if(r>this._maxCacheSize){this._logger.debug("All playing players are using more than the max cache size. Cleaning...",r,this._maxCacheSize);let i=this._maxCacheSize/e.length;e.forEach(e=>F(e,i)),t.forEach(e=>F(e,0))}else this._logger.debug("Recalculating cache sizes...",r+i,this._maxCacheSize),e.concat(t).reduce((e,t)=>(F(t,Math.max(0,this._maxCacheSize-e)),e+(t.getMemoryCacheUsage()||0)),0);this._updateTimer=window.setTimeout(()=>this._update(),2e4)}}let N=Error("No more attempts to retrieve URL.");class j extends b.errors.PlayerFatalError{constructor(e){super(e||"There was no format available that a player was able to play.")}getCode(){return"SCAUDIO.NOT_SUPPORTED_ERROR"}}class B extends j{constructor(){super("There were no stream URLs.")}getCode(){return"SCAUDIO.NO_STREAMS"}}function W(e,t){return void 0!==e?e:t}class H{constructor(e){this._player=e,this._onConnectionRequired=new b.eventDispatcher.EventDispatcher,this._onConnectionRecovered=new b.eventDispatcher.EventDispatcher,this._connectionRequired=!1,this._connectionLossTimer=null,this.onConnectionRequired=this._onConnectionRequired.getHandle(),this.onConnectionRecovered=this._onConnectionRecovered.getHandle();let t=()=>this._calculateIfConnectionRequired();window.addEventListener("online",t),window.addEventListener("offline",t),this._calculateIfConnectionRequired(),e.onChange.subscribe(({loading:r,dead:i})=>{i&&null!==this._connectionLossTimer&&(window.clearTimeout(this._connectionLossTimer),window.removeEventListener("online",t),window.removeEventListener("offline",t)),e.isDead()||void 0===r||this._calculateIfConnectionRequired()})}isConnectionRequired(){return this._connectionRequired}_calculateIfConnectionRequired(){this._player.isLoading()&&"navigator"in window&&!window.navigator.onLine?null===this._connectionLossTimer&&(this._connectionLossTimer=window.setTimeout(()=>{this._connectionLossTimer=null,this._connectionRequired=!0,this._onConnectionRequired.dispatch(void 0)},1500)):this._connectionRequired?(this._connectionRequired=!1,this._onConnectionRecovered.dispatch(void 0)):null!==this._connectionLossTimer&&(window.clearTimeout(this._connectionLossTimer),this._connectionLossTimer=null)}}class V extends j{constructor(){super("Failed to retrieve stream url.")}getCode(){return"SCAUDIO.FAILED_RETRIEVING_URL"}}let q=b.eventDispatcher.EventDispatcher,z=b.helpers.Promise,G=b.helpers.deferred.buildDeferred,Q=new U(15e7,b.logger.noOpLogger),K=-1,$=[],J=1,Y=!1;function Z(e,t,r){return Math.min(t,Math.max(e,r))}function X(e){if("number"!=typeof e)throw Error("level must be a number.");if(e<0||e>1)throw Error("Invalid volume level.");J=e,$.forEach(t=>t.setVolume(e))}function ee(){return J}function et(e){if("boolean"!=typeof e)throw Error("muteEnabled must be a boolean.");Y=e,$.forEach(t=>t.setMuted(e))}function er(){return Y}function ei(e){if("number"!=typeof e||e<0)throw Error("Invalid size.");Q.setCacheSize(e)}class en extends b.ProxyPlayerBase{constructor(e){super(e),this._onPreloadingEnabled=new q,this._onPreloadingDisabled=new q,this._retryDelayCalculator=new v,this._errorEventGenerator=null,this._fadeOutVolumeAutomator=null,this._volumeAutomators=[],this._volumeScale=1,this._userVolume=1,this._volumeAutomationSupported=!1,this._timer=null,this._pauseFadeTimer=null,this._pauseFadeDeferred=null,this._pauseFade=null,this._executionState={state:"IDLE"},this._preloadingListeners=[],this._retrieveAndBuildTimer=null,this._hadAStreamUrl=!1;let t=this._config=function(e){if(!(e.streamUrlRetriever instanceof p))throw Error("StreamUrlRetriever invalid.");if(void 0!==e.duration&&("number"!=typeof e.duration||e.duration<0))throw Error("duration invalid.");if(void 0!==e.getURLOpts&&"object"!=typeof e.getURLOpts)throw Error("getURLOpts invalid.");if(void 0!==e.preloadingEnabled&&"boolean"!=typeof e.preloadingEnabled)throw Error("preloadingEnabled invalid.");if(void 0!==e.fadeOnPauseAndPlay&&"boolean"!=typeof e.fadeOnPauseAndPlay)throw Error("fadeOnPauseAndPlay invalid.");if(void 0!==e.fadeOnSeek&&"boolean"!=typeof e.fadeOnSeek)throw Error("fadeOnSeek invalid.");if(void 0!==e.mediaSessionEnabled&&"boolean"!=typeof e.mediaSessionEnabled)throw Error("mediaSessionEnabled invalid.");if(void 0!==e.pausedMaxBufferLength&&("number"!=typeof e.pausedMaxBufferLength||e.pausedMaxBufferLength<0))throw Error("pausedMaxBufferLength invalid.");if(void 0!==e.playingMaxBufferLength&&("number"!=typeof e.playingMaxBufferLength||e.playingMaxBufferLength<0))throw Error("playingMaxBufferLength invalid.");if(void 0!==e.logger&&"function"!=typeof e.logger&&"object"!=typeof e.logger)throw Error("logger invalid.");if(void 0!==e.audioReporter&&"function"!=typeof e.audioReporter)throw Error("audioReporter invalid.");if(void 0!==e.audioCheckpointInterval&&("number"!=typeof e.audioCheckpointInterval||e.audioCheckpointInterval<0))throw Error("audioCheckpointInterval invalid.");if(void 0!==e.audioPerformanceReporter&&"function"!=typeof e.audioPerformanceReporter)throw Error("audioPerformanceReporter invalid.");if(void 0!==e.errorReporter&&"function"!=typeof e.errorReporter)throw Error("errorReporter invalid.");if(void 0!==e.urlProviderRetryDelayCalculator&&"function"!=typeof e.urlProviderRetryDelayCalculator)throw Error("urlProviderRetryDelayCalculator invalid.");return{controllers:e.controllers,streamUrlRetriever:e.streamUrlRetriever,getURLOpts:W(e.getURLOpts,{}),preloadingEnabled:W(e.preloadingEnabled,!1),pausedMaxBufferLength:W(e.pausedMaxBufferLength,2e3),playingMaxBufferLength:W(e.playingMaxBufferLength,9e4),fadeOnPauseAndPlay:W(e.fadeOnPauseAndPlay,!1),fadeOnSeek:W(e.fadeOnSeek,!1),audioCheckpointInterval:W(e.audioCheckpointInterval,3e4),urlProviderRetryDelayCalculator:W(e.urlProviderRetryDelayCalculator,b.helpers.retry.buildExponentialDelayCalculator()),streamUrlsExpire:W(e.streamUrlsExpire,!0),fetchEnabled:W(e.fetchEnabled,!0),duration:e.duration,audioReporter:e.audioReporter,audioPerformanceReporter:e.audioPerformanceReporter,errorReporter:e.errorReporter,seekStrategy:e.seekStrategy,useIphoneHlsHack:W(e.useIphoneHlsHack,!1),fairPlayManager:e.fairPlayManager,applicationId:e.applicationId}}(e);this._preloadingEnabled=t.preloadingEnabled,this._getURLOpts=t.getURLOpts,this._controllers=t.controllers;let r=this._connectionRequiredHelper=new H(this);this.onPreloadingEnabled=this._onPreloadingEnabled.getHandle(),this.onPreloadingDisabled=this._onPreloadingDisabled.getHandle(),this.onConnectionRequired=r.onConnectionRequired,this.onConnectionRecovered=r.onConnectionRecovered,this.onChange.subscribe(e=>{this.isDead()||((!1===e.playing||e.positionJumped||e.stalled||e.ended)&&this._completePauseFade(),this._pauseFade&&(!1===e.actuallyPlaying||e.ended||!0===e.playing)&&(this._removeVolumeAutomator(this._pauseFade),this._pauseFade=null),(e.positionJumped||void 0!==e.actuallyPlaying||void 0!==e.stalled)&&this._updateVolume(),void 0!==e.playing&&this._updateMaxBufferLength())});let i=`SCAudio-${++K}`,n=t.streamUrlRetriever.getTrackId();null!==n&&(i+=`-${n}`);let a=new w,o=b.logger.cloneLogger(a,this._logger);this._logger=b.logger.prefixLogger(o,i);let s=function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let r=0;r<20;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}();this._logger.info("Building player...",{ua:navigator.userAgent,getURLOpts:this._getURLOpts,logId:s}),$.push(this),this.setVolume(J,Y),this._updateFadeOut();let l=null,d=null;t.audioPerformanceReporter&&(l=new R(this,()=>this._getPlayer(),t.audioPerformanceReporter,this._logger,()=>this._getActivePlayerDetails())),t.audioReporter&&new M(this,t.audioReporter,t.audioCheckpointInterval,this._logger,()=>this._getActivePlayerDetails()),t.errorReporter&&(d=this._errorEventGenerator=new O(this,a,s,n,t.errorReporter,this._logger)),this._excludeUnsupportedRenditions();let h=this._controllerManager=new D({logger:this._logger,seekStrategy:this._config.seekStrategy,controllers:t.controllers,playerId:i,streamUrlsExpire:t.streamUrlsExpire,fetchEnabled:t.fetchEnabled,fadeOnPauseAndPlay:t.fadeOnPauseAndPlay,fadeOnSeek:t.fadeOnSeek,cacheManager:Q,providePlayer:(e,t,r)=>{this._volumeAutomationSupported=r,this._providePlayer(e,t),this._updateMaxBufferLength()},removePlayer:()=>{this._getPlayer()&&this._removePlayer()},streamUrlRetriever:this._config.streamUrlRetriever,getURLOpts:this._getURLOpts,errorEventGenerator:d||void 0,audioPerformanceEventGenerator:l||void 0,useIphoneHlsHack:t.useIphoneHlsHack||!1,fairPlayManager:t.fairPlayManager,applicationId:t.applicationId});if(this.onQualityChanged=h.onQualityChanged,void 0!==t.duration&&(this._logger.debug("Setting initial duration.",t.duration),this._setInitialDuration(t.duration)),this._preloadingEnabled)this._logger.debug("Preloading is enabled, so performing retrieve immediately."),this._retrieveAndBuild();else{this._logger.debug("Preloading is disabled, so deferring retrieve until either a play intent or preloading is enabled.");let e=()=>{this._removePreloadingListeners(),this._logger.debug("Preloading now enabled or received a play request. Peforming retrieve."),this._retrieveAndBuild()};this._preloadingListeners.push(this.onPreloadingEnabled.subscribe(e),this.onPlayIntent.subscribe(e))}}reload(e={}){this._ensureNotDead(),this._reloadStreamUrls(e)}enablePreloading(){!this.isDead()&&(this._preloadingEnabled||(this._preloadingEnabled=!0,this._updateMaxBufferLength(),this._onPreloadingEnabled.dispatch(void 0)))}disablePreloading(){!this.isDead()&&this._preloadingEnabled&&(this._preloadingEnabled=!1,this._updateMaxBufferLength(),this._onPreloadingDisabled.dispatch(void 0))}isPreloadingEnabled(){return this._preloadingEnabled}pauseAfterFade(e){if(this._ensureNotDead(),this._pauseFadeDeferred)return this._pauseFadeDeferred.promise;if(!this.isPlaying()||!this.isActuallyPlaying())return z.resolve(this.pause());let t=G();this._pauseFadeDeferred=t;let r=this.getPosition();if(this._pauseFade)throw Error("Fade should not already be assigned.");return this._pauseFade=new c({startPos:r,endPos:r+e,startLevel:1,endLevel:0}),this._addVolumeAutomator(this._pauseFade),this._pauseFadeTimer=window.setTimeout(()=>{this._pauseFadeDeferred=null,t.resolve(this.pause({fadeDuration:0}))},e+50),t.promise}isConnectionRequired(){return this._connectionRequiredHelper.isConnectionRequired()}getQuality(){return this._controllerManager.getQuality()}getVolume(){return this._volumeAutomationSupported?this._userVolume:super.getVolume()}_handleFatalError(e){this._logger.warn("Fatal error from current player.",e)}_handleVolumeChange(e,t){this._userVolume=e,super._notifyVolumeChange(e,t),this._calculateAndSetVolume()}_notifyVolumeChange(){}_kill(){super._kill(),this._timer&&window.clearTimeout(this._timer),this._abortPauseFade(),this._removePreloadingListeners(),$.splice($.indexOf(this),1),"RETRIEVING_URL"===this._executionState.state?this._executionState.retrieveJob.abort():"CONTROLLING_PLAYER"===this._executionState.state&&this._controllerManager.releaseCurrentController({retry:!1}),this._executionState={state:"DEAD"},this._retrieveAndBuildTimer&&window.clearTimeout(this._retrieveAndBuildTimer)}_excludeUnsupportedRenditions(){let e={streamUrlExpires:this._config.streamUrlsExpire};y.filter(t=>!this._controllers.some(r=>r.isRenditionSupported(t,e,{useIphoneHlsHack:this._config.useIphoneHlsHack||!1,fairPlayManager:this._config.fairPlayManager}))).forEach(e=>{this._config.streamUrlRetriever.excludeRendition(e)})}_addVolumeAutomator(e){0>this._volumeAutomators.indexOf(e)&&(this._volumeAutomators.push(e),this._updateVolume())}_removeVolumeAutomator(e){let t=this._volumeAutomators.indexOf(e);t>=0&&(this._volumeAutomators.splice(t,1),this._updateVolume())}_removePreloadingListeners(){this._preloadingListeners.forEach(e=>e.remove())}_getActivePlayerDetails(){return"CONTROLLING_PLAYER"!==this._executionState.state?null:this._controllerManager.getPlayerDetails()}_updateFadeOut(){this._fadeOutVolumeAutomator&&this._removeVolumeAutomator(this._fadeOutVolumeAutomator),this._getURLOpts.snippet&&(this._fadeOutVolumeAutomator=_(3e3),this._addVolumeAutomator(this._fadeOutVolumeAutomator))}_handleUnexpectedError(e){try{e()}catch(e){this._logger.error("Unexpected error.",e),this._triggerError(new b.errors.PlayerFatalError("An unexpected error occurred.",e))}}_retrieveAndBuild(){this._handleUnexpectedError(()=>{if(-1===["IDLE","WAITING_TO_RETRIEVE"].indexOf(this._executionState.state))throw Error("Invalid state for retrieveAndBuild().");this._logger.debug("Retrieving URL...");let e=function({streamUrlRetriever:e,getURLOpts:t,logger:r,urlProviderRetryDelayCalculator:i}){return new b.helpers.abortableJob.AbortableJob(()=>{let n=b.helpers.deferred.buildDeferred(),{cancel:a}=b.helpers.retry.retry(i,({scheduleRetry:i})=>{let a=e.getUrl(t);return r.debug("Retrieving a URL..."),a.onCompletion(t=>{t?t.rendition&&0>y.indexOf(t.rendition)?(r.warn("Unknown rendition. Skipping...",t.rendition),e.excludeRendition(t.rendition),i()):!t.success&&!1===t.success&&t.error.isTransient()?(r.warn("Transient error retrieving url.",t.error),i()):n.resolve(t):(r.debug("No URL provided."),n.resolve(null))}),a.onError(e=>{e!==b.helpers.abortableJob.abortedError&&r.error("Error retrieving URL.",e),n.reject(e)}),{onCancel:()=>a.abort()}},{onNoMoreRetries:()=>n.reject(N)});return{result:n.promise,abort:()=>a()}}).run()}({streamUrlRetriever:this._config.streamUrlRetriever,urlProviderRetryDelayCalculator:this._config.urlProviderRetryDelayCalculator,getURLOpts:this._getURLOpts,logger:this._logger});this._executionState={state:"RETRIEVING_URL",retrieveJob:e},e.onCompletion(e=>{if(this._logger.debug("Retrieved URL.",!!e),e&&e.success){this._hadAStreamUrl=!0;let t=!1,r=({excludeRendition:r,immediateRetry:i})=>{this._handleUnexpectedError(()=>{if(t)throw Error("startOver called multiple times.");if(t=!0,r&&this._config.streamUrlRetriever.excludeRendition(e.rendition),this._executionState={state:"WAITING_TO_RETRIEVE"},this.isDead()){this._logger.debug("Stopping execution because player is dead.");return}if(i)this._logger.debug("Moving on immediately."),this._retrieveAndBuild();else{let e=this._retryDelayCalculator.getDelay();this._logger.debug(`Will move on in ${e}ms.`),e?this._retrieveAndBuildTimer=window.setTimeout(()=>this._retrieveAndBuild(),e):this._retrieveAndBuild()}})};this._handleUnexpectedError(()=>{this._executionState={state:"CONTROLLING_PLAYER"},this._logger.debug("Building controller..."),this._controllerManager.buildNextController(e,r),this._logger.debug("Built controller.")})}else if(e&&e.rendition&&!1===e.success){if(this._logger.warn("Error retrieving URL. Moving on.",e.error),this._errorEventGenerator){let t=`SCAUDIO.URL_RETRIEVER_ERROR.${this._config.streamUrlRetriever.name}.${e.error.getCode()}`;this._errorEventGenerator.reportManualEvent(t,{preset:e.preset,quality:e.quality,bitrate:e.bitrate,format:e.rendition.scFormat,protocol:e.rendition.scProtocol})}this._config.streamUrlRetriever.excludeRendition(e.rendition),this._executionState={state:"WAITING_TO_RETRIEVE"},this._retrieveAndBuild()}else e&&e.rendition&&!1===e.success&&this._logger.warn("Error retrieving URL for any rendition.",e.error),this._logger.info("Ran out of streams.",this._hadAStreamUrl),this._triggerError(this._hadAStreamUrl?new j:new B)}),e.onError(e=>{e!==b.helpers.abortableJob.abortedError&&(e===N?this._logger.error("Ran out of retries to retrieve URL."):this._logger.error("Unexpected error when retrieving a URL.",e),this._triggerError(new V))})})}_reloadStreamUrls(e){this._getURLOpts=e,this._updateFadeOut(),this._logger.info("Reloading stream URL's...",this._getURLOpts),"RETRIEVING_URL"===this._executionState.state?(this._logger.debug("Aborting current URL retrieve."),this._executionState.retrieveJob.abort(),this._executionState={state:"WAITING_TO_RETRIEVE"},this._retrieveAndBuild()):"CONTROLLING_PLAYER"===this._executionState.state?(this._logger.debug("Releasing controller."),this._controllerManager.releaseCurrentController({retry:!0})):this._logger.debug("Nothing to do."),this._logger.info("Reloaded stream URL's.")}_completePauseFade(){if(this._pauseFadeDeferred){this._pauseFadeTimer&&window.clearTimeout(this._pauseFadeTimer);let e=this._pauseFadeDeferred;this._pauseFadeDeferred=null,e.resolve(this.pause())}}_abortPauseFade(){this._pauseFadeTimer&&(window.clearTimeout(this._pauseFadeTimer),this._pauseFadeTimer=null),this._pauseFadeDeferred&&(this._pauseFadeDeferred.reject(Error("Player was killed.")),this._pauseFadeDeferred=null)}_updateVolume(){if(!this._volumeAutomationSupported)return;this._ensureNotDead(),this._timer&&(window.clearTimeout(this._timer),this._timer=null);let e=this.getDuration();if(null===e)return;let t=this._volumeAutomators,r=this.getPosition(),i=1/0,n=1;t.forEach(t=>{let{nextCalculatePosition:a,level:o}=t.calculate(r,e);n*=Z(0,1,o),a<i&&(i=a)}),this._volumeScale!==n&&(this._volumeScale=n,this._calculateAndSetVolume()),i<1/0&&this.isActuallyPlaying()&&!this.isStalled()&&(this._timer=window.setTimeout(()=>{this._timer=null,this._updateVolume()},Z(100,5e3,i-this.getPosition())))}_calculateAndSetVolume(){this._volumeAutomationSupported?super._handleVolumeChange(this._userVolume*this._volumeScale,this.getMuted()):super._handleVolumeChange(this._userVolume,this.getMuted())}_updateMaxBufferLength(){let e=this._getPlayer(),t=e&&e.getBufferController();t&&(this.isPlaying()?t.setMaxBufferLength(this._config.playingMaxBufferLength):t.setMaxBufferLength(this._preloadingEnabled?this._config.pausedMaxBufferLength:0))}}var ea=h(64);let eo=b.logger.prefixLogger;class es{constructor(e,t){this._cleanupCallbacks=[],this._licenseUrl=e+"/playback/fairplay",this._logger=eo(t,"LegacyFairPlayManager")}static isSupported(){return!!window.WebKitMediaKeys}registerPlayer(e){this._unregister();let t=e.onChange.subscribe(({playing:t})=>{var r;let i=e.getMediaElement();t&&i&&i!==this._attachedMediaElement&&(this._attachedMediaElement=i,this._applicationCertificate?this._registerMediaElement(i):(this._applicationCertificatePromise||this._requestApplicationCertificate(),null===(r=this._applicationCertificatePromise)||void 0===r||r.then(()=>this._registerMediaElement(i))))});this._cleanupCallbacks.push(()=>t.remove())}_unregister(){for(let e=0;e<this._cleanupCallbacks.length;++e){let t=this._cleanupCallbacks[e];try{t()}catch(e){this._logger.warn("Error calling cleanup function to unregister player.",e)}}this._attachedMediaElement=void 0,this._cleanupCallbacks=[]}_requestApplicationCertificate(){this._logger.debug("Requesting fairplay application certificate");let e=this._licenseUrl,t=ea.arrayBufferLoader.request({url:e});this._applicationCertificatePromise=t.getResponse().then(e=>{if(!e)throw Error("No response requesting application certificate");if(200!==e.statusCode)throw Error(`Received status ${e.statusCode} requesting application certificate`);let t=e.getData();this._applicationCertificate=new Uint8Array(t),this._applicationCertificatePromise=void 0,this._logger.debug("Application certificate received")}).catch(e=>{this._logger.error("Error requesting application certificate.",e)})}_onWebKitNeedKey(e,t,r){let i=function(e){let t=String.fromCharCode.apply(null,new Uint16Array(e.buffer)),r=t.indexOf("skd://")+6;return t.substring(r)}(r.initData),n=function(e,t,r){let i=function(e){let t=new Uint16Array(new ArrayBuffer(2*e.length));for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(t),n=0,a=new ArrayBuffer(e.byteLength+4+i.byteLength+4+r.byteLength),o=new DataView(a);new Uint8Array(a,n,e.byteLength).set(e),n+=e.byteLength,o.setUint32(n,i.byteLength,!0);let s=new Uint16Array(a,n+=4,i.length);return s.set(i),n+=s.byteLength,o.setUint32(n,r.byteLength,!0),new Uint8Array(a,n+=4,r.byteLength).set(r),new Uint8Array(a,0,a.byteLength)}(r.initData,i,t),a=new window.WebKitMediaKeys("com.apple.fps.1_0");e.webkitSetMediaKeys(a);let o=a.createSession("application/vnd.apple.mpegurl",n),s=e=>{var t;this._logger.debug("webkitkeymessage event received");let r=(t=new Uint8Array(e.message),btoa(String.fromCodePoint.apply(null,t)));this._requestLicense(this._licenseUrl,r,i).then(e=>{o.update(e)}).catch(e=>{this._logger.error("Error requesting fairplay license",e)})};o.addEventListener("webkitkeymessage",s),this._cleanupCallbacks.push(()=>o.removeEventListener("webkitkeymessage",s)),this._cleanupCallbacks.push(()=>o.close())}_requestLicense(e,t,r){return this._logger.debug("Requesting license"),fetch(e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`spc=${t}&assetId=${r}`,method:"POST"}).then(e=>{if(!e)throw Error("No response requesting fairplay license");if(200!==e.status)throw Error(`Received status ${e.status} requesting fairplay license`);return this._logger.debug("License received"),e.arrayBuffer()}).then(e=>(function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})(atob(new TextDecoder().decode(e).trim())))}_registerMediaElement(e){let t=t=>{this._logger.debug("webkitneedkey event received"),this._applicationCertificate&&this._onWebKitNeedKey(e,this._applicationCertificate,t)};e.addEventListener("webkitneedkey",t),this._cleanupCallbacks.push(()=>e.removeEventListener("webkitneedkey",t))}}function el(e){switch(e){case o.SQ:return o.SQ;case o.HQ:return o.HQ}return null}(i=o||(o={})).SQ="sq",i.HQ="hq",(n=s||(s={})).NotSupportedError=j,n.NoStreamsError=B,n.FailedRetrievingUrlError=V;let ed="24.1.3",eh=1201;return u})(),e.exports=i(r(48567),r(8636))}}]);